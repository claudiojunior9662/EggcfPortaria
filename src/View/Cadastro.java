/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package View;

import Connection.ConnectionFactory;
import com.github.sarxos.webcam.Webcam;
import com.github.sarxos.webcam.WebcamException;
import com.github.sarxos.webcam.WebcamResolution;
import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Component;
import java.awt.Dimension;
import java.awt.Graphics2D;
import java.awt.Image;
import java.awt.image.BufferedImage;
import java.io.ByteArrayInputStream;
import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.sql.Connection;
import java.sql.SQLException;
import java.text.SimpleDateFormat;
import java.util.Calendar;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.imageio.ImageIO;
import javax.swing.DefaultListModel;
import javax.swing.ImageIcon;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.JTable;
import javax.swing.table.DefaultTableCellRenderer;
import javax.swing.table.DefaultTableModel;
import model.bean.CadastroBEAN;
import model.bean.ControleExpedienteBEAN;
import model.dao.cadastroDAO;
import model.dao.controleDAO;
import java.util.Date;
import java.util.GregorianCalendar;
import javax.swing.table.TableRowSorter;
import model.bean.ControleForaExpedienteBEAN;
import model.dao.PreencheServicoDAO;
import model.dao.controlefDAO;

/**
 *
 * @author claud
 */
public class Cadastro extends javax.swing.JFrame {
        BufferedImage imageArray = null;
        BufferedImage imageArray_controle = null;
        BufferedImage imageArray_controlef = null;
        private Dimension dimensao_default;
        private Webcam WEBCAM;
        boolean executando = true;
        boolean executando2 = true;
        DefaultListModel model_list;
        DefaultListModel model_list2;
        DefaultListModel model_list3;
        int red = 0;
        int red_controle = 0;
        int red_controlef = 0;
        boolean webcam_found = false;
        
    public Cadastro() throws SQLException {
        initComponents();
        this.setLocationRelativeTo(null);
        this.setExtendedState(this.MAXIMIZED_BOTH);
        try{
                Connection con = ConnectionFactory.getConnection();
                ConnectionFactory.closeConnection(con);
            }catch(Exception e){
                JOptionPane.showMessageDialog(null,"Erro ao obter conexão com o banco de dados! " + e);
            }
        
        try{
            INICIALIZA();
            webcam_found = true;
        }catch(Exception e){
            JOptionPane.showMessageDialog(null,"Nao foi detectado nenhum dispositivo de video!\n O programa nao ira ser capaz de capturar imagens!\n Favor conecte um dispositivo de video e abra o programa novamente! "+ e);
            iniciar_video_registro_visitantes.setEnabled(false);
            iniciar_video_controle_saida.setEnabled(false);
            webcam_found = false;
        }
        
        readJTable();
        readJTable_controle();
        readJTable_controlef();
        
        //Modela a lista de pesquisa do Registro de Visitantes
        lista_pesquisa_registro_visitantes.setVisible(false);
        model_list = new DefaultListModel();
        lista_pesquisa_registro_visitantes.setModel(model_list);
        
        //Modela a lista de pesquisa do Controle de Saída de CB/SD
        lista_pesquisa_controle_saida.setVisible(false);
        model_list2 = new DefaultListModel();
        lista_pesquisa_controle_saida.setModel(model_list2);
        
        //Modela a lista de pesquisa do ControleExpedienteBEAN de entrada fora do expediente
        lista_pesquisa_controle_entrada.setVisible(false);
        model_list3 = new DefaultListModel();
        lista_pesquisa_controle_entrada.setModel(model_list3);
        
        //Verifica se existe algum serviço em aberto
        
        
        
        
        
}

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        buttonGroup1 = new javax.swing.ButtonGroup();
        buttonGroup2 = new javax.swing.ButtonGroup();
        jTabbedPane1 = new javax.swing.JTabbedPane();
        jPanel1 = new javax.swing.JPanel();
        cadastrar_visitante = new javax.swing.JButton();
        redefinir_visitante = new javax.swing.JButton();
        jScrollPane3 = new javax.swing.JScrollPane();
        controle_tabela = new javax.swing.JTable();
        def_horario_saida_visitante = new javax.swing.JButton();
        novo_visitante = new javax.swing.JButton();
        ferramentas_adm_visitante = new javax.swing.JButton();
        jScrollPane5 = new javax.swing.JScrollPane();
        txt_info = new javax.swing.JTextPane();
        sair_button = new javax.swing.JButton();
        associar_button = new javax.swing.JButton();
        jPanel5 = new javax.swing.JPanel();
        jPanel12 = new javax.swing.JPanel();
        lista_pesquisa_registro_visitantes = new javax.swing.JList<>();
        nome_visitante = new javax.swing.JTextField();
        jLabel1 = new javax.swing.JLabel();
        pesquisa_registro_visitantes = new javax.swing.JTextField();
        jLabel8 = new javax.swing.JLabel();
        jLabel3 = new javax.swing.JLabel();
        numero_doc_visitante = new javax.swing.JTextField();
        jLabel2 = new javax.swing.JLabel();
        tipo_doc_visitante = new javax.swing.JComboBox<>();
        Civil = new javax.swing.JRadioButton();
        Militar = new javax.swing.JRadioButton();
        txtVisitante = new javax.swing.JLabel();
        Fornec = new javax.swing.JRadioButton();
        jLabel5 = new javax.swing.JLabel();
        jLabel7 = new javax.swing.JLabel();
        telefone_visitante = new javax.swing.JFormattedTextField();
        destino_visitante = new javax.swing.JTextField();
        jLabel4 = new javax.swing.JLabel();
        com_quem_falar_visitante = new javax.swing.JTextField();
        jPanel3 = new javax.swing.JPanel();
        c4 = new javax.swing.JCheckBox();
        c2 = new javax.swing.JCheckBox();
        c3 = new javax.swing.JCheckBox();
        c5 = new javax.swing.JCheckBox();
        c10 = new javax.swing.JCheckBox();
        c1 = new javax.swing.JCheckBox();
        c6 = new javax.swing.JCheckBox();
        c7 = new javax.swing.JCheckBox();
        c9 = new javax.swing.JCheckBox();
        c8 = new javax.swing.JCheckBox();
        c11 = new javax.swing.JCheckBox();
        c15 = new javax.swing.JCheckBox();
        c19 = new javax.swing.JCheckBox();
        c20 = new javax.swing.JCheckBox();
        c12 = new javax.swing.JCheckBox();
        c14 = new javax.swing.JCheckBox();
        c16 = new javax.swing.JCheckBox();
        c17 = new javax.swing.JCheckBox();
        c18 = new javax.swing.JCheckBox();
        c13 = new javax.swing.JCheckBox();
        foto_visitante = new javax.swing.JLabel();
        iniciar_video_registro_visitantes = new javax.swing.JButton();
        capturar_video_registro_visitantes = new javax.swing.JButton();
        jPanel2 = new javax.swing.JPanel();
        jLabel15 = new javax.swing.JLabel();
        def_horario_entrada_controle = new javax.swing.JButton();
        jScrollPane6 = new javax.swing.JScrollPane();
        txt_info2 = new javax.swing.JTextPane();
        ferramentas_adm_controle_saida = new javax.swing.JButton();
        jPanel4 = new javax.swing.JPanel();
        lista_pesquisa_controle_saida = new javax.swing.JList<>();
        posto_graduacao_controle_saida = new javax.swing.JComboBox<>();
        jLabel11 = new javax.swing.JLabel();
        jLabel12 = new javax.swing.JLabel();
        nome_guerra_controle_saida = new javax.swing.JTextField();
        jLabel13 = new javax.swing.JLabel();
        sessao_controle_saida = new javax.swing.JComboBox<>();
        jLabel14 = new javax.swing.JLabel();
        motivo_controle_saida = new javax.swing.JTextField();
        jPanel8 = new javax.swing.JPanel();
        foto_controle_saida = new javax.swing.JLabel();
        iniciar_video_controle_saida = new javax.swing.JButton();
        capturar_video_controle_saida = new javax.swing.JButton();
        novo_saida = new javax.swing.JButton();
        redefinir_saida = new javax.swing.JButton();
        cadastrar_saida = new javax.swing.JButton();
        jLabel9 = new javax.swing.JLabel();
        jScrollPane2 = new javax.swing.JScrollPane();
        controle_tabela_saida = new javax.swing.JTable();
        pesquisa_controle_saida = new javax.swing.JTextField();
        sair_controle = new javax.swing.JButton();
        jPanel7 = new javax.swing.JPanel();
        jLabel16 = new javax.swing.JLabel();
        def_horario_saida_entrada = new javax.swing.JButton();
        jScrollPane7 = new javax.swing.JScrollPane();
        txt_info3 = new javax.swing.JTextPane();
        ferramentas_adm_controle_entrada = new javax.swing.JButton();
        jPanel9 = new javax.swing.JPanel();
        lista_pesquisa_controle_entrada = new javax.swing.JList<>();
        posto_graduacao_controle_entrada = new javax.swing.JComboBox<>();
        jLabel18 = new javax.swing.JLabel();
        jLabel19 = new javax.swing.JLabel();
        nome_guerra_controle_entrada = new javax.swing.JTextField();
        jLabel20 = new javax.swing.JLabel();
        sessao_controle_entrada = new javax.swing.JComboBox<>();
        jLabel21 = new javax.swing.JLabel();
        motivo_controle_entrada = new javax.swing.JTextField();
        jPanel10 = new javax.swing.JPanel();
        foto_controle_entrada = new javax.swing.JLabel();
        iniciar_video_controle_entrada = new javax.swing.JButton();
        capturar_video_controle_entrada = new javax.swing.JButton();
        novo_entrada = new javax.swing.JButton();
        redefinir_entrada = new javax.swing.JButton();
        cadastrar_entrada = new javax.swing.JButton();
        jScrollPane4 = new javax.swing.JScrollPane();
        controle_tabela_saida1 = new javax.swing.JTable();
        pesquisa_controle_entrada = new javax.swing.JTextField();
        sair_controle1 = new javax.swing.JButton();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
        setTitle("EGGCF Portaria");
        setExtendedState(6);
        setState(6);
        getContentPane().setLayout(new java.awt.GridLayout(1, 0));

        jTabbedPane1.setPreferredSize(new java.awt.Dimension(1098, 100));

        jPanel1.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jPanel1MouseClicked(evt);
            }
        });

        cadastrar_visitante.setIcon(new javax.swing.ImageIcon(getClass().getResource("/icones/cadastrar.png"))); // NOI18N
        cadastrar_visitante.setToolTipText("Cadastrar");
        cadastrar_visitante.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cadastrar_visitanteActionPerformed(evt);
            }
        });

        redefinir_visitante.setIcon(new javax.swing.ImageIcon(getClass().getResource("/icones/editar.png"))); // NOI18N
        redefinir_visitante.setToolTipText("Redefinir");
        redefinir_visitante.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                redefinir_visitanteActionPerformed(evt);
            }
        });

        controle_tabela.setBorder(javax.swing.BorderFactory.createEtchedBorder());
        controle_tabela.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "ID", "Crachá", "Nome ", "Tipo Doc", "Nº", "Destino", "Com Quem Falar", "Tel", "Tipo Visitante", "Data", "Hora Entrada", "Hora Saída"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.Integer.class, java.lang.Integer.class, java.lang.Object.class, java.lang.Object.class, java.lang.Object.class, java.lang.Object.class, java.lang.Object.class, java.lang.Object.class, java.lang.Object.class, java.lang.Object.class, java.lang.Object.class, java.lang.Object.class
            };
            boolean[] canEdit = new boolean [] {
                false, false, false, false, false, false, false, false, false, false, false, false
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        controle_tabela.setToolTipText("");
        controle_tabela.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                controle_tabelaMouseClicked(evt);
            }
        });
        jScrollPane3.setViewportView(controle_tabela);
        if (controle_tabela.getColumnModel().getColumnCount() > 0) {
            controle_tabela.getColumnModel().getColumn(0).setPreferredWidth(50);
            controle_tabela.getColumnModel().getColumn(1).setPreferredWidth(70);
            controle_tabela.getColumnModel().getColumn(2).setPreferredWidth(200);
            controle_tabela.getColumnModel().getColumn(5).setPreferredWidth(150);
        }

        def_horario_saida_visitante.setText("Definir horário de saída");
        def_horario_saida_visitante.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                def_horario_saida_visitanteActionPerformed(evt);
            }
        });

        novo_visitante.setIcon(new javax.swing.ImageIcon(getClass().getResource("/icones/adicionar.png"))); // NOI18N
        novo_visitante.setToolTipText("Novo Cadastro");
        novo_visitante.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                novo_visitanteActionPerformed(evt);
            }
        });

        ferramentas_adm_visitante.setText("Ferramentas de Administrador");
        ferramentas_adm_visitante.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                ferramentas_adm_visitanteActionPerformed(evt);
            }
        });

        jScrollPane5.setViewportView(txt_info);

        sair_button.setText("Sair");
        sair_button.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                sair_buttonActionPerformed(evt);
            }
        });

        associar_button.setIcon(new javax.swing.ImageIcon(getClass().getResource("/icones/associarVeiculo.png"))); // NOI18N
        associar_button.setToolTipText("Associar Veículo");
        associar_button.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                associar_buttonActionPerformed(evt);
            }
        });

        jPanel5.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        jPanel12.setBorder(new javax.swing.border.SoftBevelBorder(javax.swing.border.BevelBorder.RAISED));
        jPanel12.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        lista_pesquisa_registro_visitantes.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                lista_pesquisa_registro_visitantesMouseClicked(evt);
            }
        });
        jPanel12.add(lista_pesquisa_registro_visitantes, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 60, 400, 120));

        nome_visitante.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                nome_visitanteActionPerformed(evt);
            }
        });
        jPanel12.add(nome_visitante, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 90, 400, -1));

        jLabel1.setText("Nome Completo:");
        jPanel12.add(jLabel1, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 70, -1, -1));

        pesquisa_registro_visitantes.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                pesquisa_registro_visitantesActionPerformed(evt);
            }
        });
        pesquisa_registro_visitantes.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                pesquisa_registro_visitantesKeyReleased(evt);
            }
        });
        jPanel12.add(pesquisa_registro_visitantes, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 30, 400, -1));

        jLabel8.setText("Pesquisa por nome:");
        jPanel12.add(jLabel8, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 10, -1, 20));

        jLabel3.setText("Tipo Documento:");
        jPanel12.add(jLabel3, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 130, 140, -1));
        jPanel12.add(numero_doc_visitante, new org.netbeans.lib.awtextra.AbsoluteConstraints(240, 150, 170, -1));

        jLabel2.setText("Número Documento:");
        jPanel12.add(jLabel2, new org.netbeans.lib.awtextra.AbsoluteConstraints(240, 130, -1, -1));

        tipo_doc_visitante.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Selecione...", "ID Militar", "RG", "CNH(Num Reg)", "Passaporte", "Carteira de Trabalho", "Certificado de Reservista" }));
        tipo_doc_visitante.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                tipo_doc_visitanteActionPerformed(evt);
            }
        });
        jPanel12.add(tipo_doc_visitante, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 150, 220, -1));

        buttonGroup1.add(Civil);
        Civil.setText("Civil");
        jPanel12.add(Civil, new org.netbeans.lib.awtextra.AbsoluteConstraints(110, 190, -1, -1));

        buttonGroup1.add(Militar);
        Militar.setText("Militar");
        jPanel12.add(Militar, new org.netbeans.lib.awtextra.AbsoluteConstraints(300, 190, -1, -1));

        txtVisitante.setText("Tipo Visitante:");
        jPanel12.add(txtVisitante, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 180, -1, 40));

        buttonGroup1.add(Fornec);
        Fornec.setText("Fornecedor");
        jPanel12.add(Fornec, new org.netbeans.lib.awtextra.AbsoluteConstraints(190, 190, -1, -1));

        jLabel5.setText("Telefone:");
        jPanel12.add(jLabel5, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 220, -1, -1));

        jLabel7.setText("Destino:");
        jPanel12.add(jLabel7, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 280, -1, -1));

        try {
            telefone_visitante.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.MaskFormatter("(##)#####-####")));
        } catch (java.text.ParseException ex) {
            ex.printStackTrace();
        }
        telefone_visitante.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                telefone_visitanteActionPerformed(evt);
            }
        });
        jPanel12.add(telefone_visitante, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 240, 139, -1));

        destino_visitante.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                destino_visitanteActionPerformed(evt);
            }
        });
        jPanel12.add(destino_visitante, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 300, 139, -1));

        jLabel4.setText("Com quem deseja falar:");
        jPanel12.add(jLabel4, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 330, -1, -1));

        com_quem_falar_visitante.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                com_quem_falar_visitanteActionPerformed(evt);
            }
        });
        jPanel12.add(com_quem_falar_visitante, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 350, 139, -1));

        jPanel3.setBorder(javax.swing.BorderFactory.createTitledBorder(new javax.swing.border.SoftBevelBorder(javax.swing.border.BevelBorder.RAISED), "Crachá"));

        buttonGroup2.add(c4);
        c4.setText("4");
        c4.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                c4ActionPerformed(evt);
            }
        });

        buttonGroup2.add(c2);
        c2.setText("2");
        c2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                c2ActionPerformed(evt);
            }
        });

        buttonGroup2.add(c3);
        c3.setText("3");
        c3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                c3ActionPerformed(evt);
            }
        });

        buttonGroup2.add(c5);
        c5.setText("5");
        c5.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                c5ActionPerformed(evt);
            }
        });

        buttonGroup2.add(c10);
        c10.setText("10");
        c10.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                c10ActionPerformed(evt);
            }
        });

        buttonGroup2.add(c1);
        c1.setText("1");
        c1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                c1ActionPerformed(evt);
            }
        });

        buttonGroup2.add(c6);
        c6.setText("6");
        c6.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                c6ActionPerformed(evt);
            }
        });

        buttonGroup2.add(c7);
        c7.setText("7");
        c7.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                c7ActionPerformed(evt);
            }
        });

        buttonGroup2.add(c9);
        c9.setText("9");
        c9.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                c9ActionPerformed(evt);
            }
        });

        buttonGroup2.add(c8);
        c8.setText("8");
        c8.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                c8ActionPerformed(evt);
            }
        });

        buttonGroup2.add(c11);
        c11.setText("11");

        buttonGroup2.add(c15);
        c15.setText("15");

        buttonGroup2.add(c19);
        c19.setText("19");

        buttonGroup2.add(c20);
        c20.setText("20");

        buttonGroup2.add(c12);
        c12.setText("12");

        buttonGroup2.add(c14);
        c14.setText("14");

        buttonGroup2.add(c16);
        c16.setText("16");
        c16.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                c16ActionPerformed(evt);
            }
        });

        buttonGroup2.add(c17);
        c17.setText("17");

        buttonGroup2.add(c18);
        c18.setText("18");

        buttonGroup2.add(c13);
        c13.setText("13");
        c13.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                c13ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel3Layout = new javax.swing.GroupLayout(jPanel3);
        jPanel3.setLayout(jPanel3Layout);
        jPanel3Layout.setHorizontalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel3Layout.createSequentialGroup()
                .addContainerGap(14, Short.MAX_VALUE)
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel3Layout.createSequentialGroup()
                        .addComponent(c1)
                        .addGap(7, 7, 7)
                        .addComponent(c2)
                        .addGap(7, 7, 7)
                        .addComponent(c3)
                        .addGap(7, 7, 7)
                        .addComponent(c4)
                        .addGap(7, 7, 7)
                        .addComponent(c5))
                    .addGroup(jPanel3Layout.createSequentialGroup()
                        .addComponent(c6)
                        .addGap(7, 7, 7)
                        .addComponent(c7)
                        .addGap(7, 7, 7)
                        .addComponent(c8)
                        .addGap(7, 7, 7)
                        .addComponent(c9)
                        .addGap(17, 17, 17)
                        .addComponent(c10))
                    .addGroup(jPanel3Layout.createSequentialGroup()
                        .addComponent(c11)
                        .addGap(0, 0, 0)
                        .addComponent(c12)
                        .addGap(0, 0, 0)
                        .addComponent(c13)
                        .addGap(0, 0, 0)
                        .addComponent(c14)
                        .addGap(10, 10, 10)
                        .addComponent(c15))
                    .addGroup(jPanel3Layout.createSequentialGroup()
                        .addComponent(c16)
                        .addGap(0, 0, 0)
                        .addComponent(c17)
                        .addGap(0, 0, 0)
                        .addComponent(c18)
                        .addGap(0, 0, 0)
                        .addComponent(c19)
                        .addGap(10, 10, 10)
                        .addComponent(c20)))
                .addContainerGap())
        );
        jPanel3Layout.setVerticalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel3Layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(c1)
                    .addComponent(c2, javax.swing.GroupLayout.PREFERRED_SIZE, 20, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(c3)
                    .addComponent(c4, javax.swing.GroupLayout.PREFERRED_SIZE, 20, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(c5))
                .addGap(7, 7, 7)
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(c6, javax.swing.GroupLayout.PREFERRED_SIZE, 20, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(c7)
                    .addComponent(c8, javax.swing.GroupLayout.PREFERRED_SIZE, 20, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(c9)
                    .addComponent(c10, javax.swing.GroupLayout.PREFERRED_SIZE, 20, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(7, 7, 7)
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(c11)
                    .addComponent(c12)
                    .addComponent(c13, javax.swing.GroupLayout.PREFERRED_SIZE, 20, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(c14)
                    .addComponent(c15))
                .addGap(7, 7, 7)
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(c16)
                    .addComponent(c17)
                    .addComponent(c18)
                    .addComponent(c19)
                    .addComponent(c20))
                .addContainerGap())
        );

        jPanel12.add(jPanel3, new org.netbeans.lib.awtextra.AbsoluteConstraints(160, 230, -1, -1));

        foto_visitante.setBackground(new java.awt.Color(0, 0, 0));
        foto_visitante.setOpaque(true);
        jPanel12.add(foto_visitante, new org.netbeans.lib.awtextra.AbsoluteConstraints(70, 400, 220, 220));

        iniciar_video_registro_visitantes.setIcon(new javax.swing.ImageIcon(getClass().getResource("/icones/iniciarGravacao.png"))); // NOI18N
        iniciar_video_registro_visitantes.setToolTipText("Iniciar Vídeo");
        iniciar_video_registro_visitantes.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                iniciar_video_registro_visitantesActionPerformed(evt);
            }
        });
        jPanel12.add(iniciar_video_registro_visitantes, new org.netbeans.lib.awtextra.AbsoluteConstraints(300, 400, -1, 38));

        capturar_video_registro_visitantes.setIcon(new javax.swing.ImageIcon(getClass().getResource("/icones/capturarFoto.png"))); // NOI18N
        capturar_video_registro_visitantes.setToolTipText("Capturar Foto");
        capturar_video_registro_visitantes.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                capturar_video_registro_visitantesActionPerformed(evt);
            }
        });
        jPanel12.add(capturar_video_registro_visitantes, new org.netbeans.lib.awtextra.AbsoluteConstraints(300, 450, -1, 38));

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(javax.swing.GroupLayout.Alignment.LEADING, jPanel1Layout.createSequentialGroup()
                        .addComponent(jPanel12, javax.swing.GroupLayout.PREFERRED_SIZE, 422, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jPanel5, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(novo_visitante)
                            .addComponent(redefinir_visitante)
                            .addComponent(cadastrar_visitante)
                            .addComponent(associar_button))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(def_horario_saida_visitante, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(jScrollPane3, javax.swing.GroupLayout.DEFAULT_SIZE, 1084, Short.MAX_VALUE)))
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addComponent(ferramentas_adm_visitante)
                        .addGap(5, 5, 5)
                        .addComponent(sair_button))
                    .addComponent(jScrollPane5))
                .addGap(6, 6, 6))
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addGap(10, 10, 10)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addGap(0, 0, Short.MAX_VALUE)
                        .addComponent(jPanel5, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(763, 763, 763))
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel1Layout.createSequentialGroup()
                                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(jScrollPane3)
                                    .addComponent(jPanel12, javax.swing.GroupLayout.PREFERRED_SIZE, 643, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(def_horario_saida_visitante, javax.swing.GroupLayout.PREFERRED_SIZE, 39, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(18, 18, 18)
                                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addGroup(jPanel1Layout.createSequentialGroup()
                                        .addGap(1, 1, 1)
                                        .addComponent(ferramentas_adm_visitante))
                                    .addComponent(sair_button))
                                .addGap(5, 5, 5)
                                .addComponent(jScrollPane5, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(jPanel1Layout.createSequentialGroup()
                                .addComponent(novo_visitante)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(redefinir_visitante)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(cadastrar_visitante)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(associar_button)))
                        .addContainerGap())))
        );

        jPanel1Layout.linkSize(javax.swing.SwingConstants.VERTICAL, new java.awt.Component[] {cadastrar_visitante, novo_visitante, redefinir_visitante});

        jTabbedPane1.addTab("Registro de Visitantes", jPanel1);

        jPanel2.setPreferredSize(new java.awt.Dimension(1000, 720));
        jPanel2.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jPanel2MouseClicked(evt);
            }
        });

        jLabel15.setText("Procurar por nome de guerra:");

        def_horario_entrada_controle.setText("Definir Horário de Entrada");
        def_horario_entrada_controle.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                def_horario_entrada_controleActionPerformed(evt);
            }
        });

        jScrollPane6.setViewportView(txt_info2);

        ferramentas_adm_controle_saida.setText("Ferramentas de Administrador");
        ferramentas_adm_controle_saida.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                ferramentas_adm_controle_saidaActionPerformed(evt);
            }
        });

        jPanel4.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Registro", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 11))); // NOI18N
        jPanel4.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        lista_pesquisa_controle_saida.setBorder(new javax.swing.border.SoftBevelBorder(javax.swing.border.BevelBorder.RAISED));
        lista_pesquisa_controle_saida.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                lista_pesquisa_controle_saidaMouseClicked(evt);
            }
        });
        jPanel4.add(lista_pesquisa_controle_saida, new org.netbeans.lib.awtextra.AbsoluteConstraints(0, 0, 290, 90));

        posto_graduacao_controle_saida.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Selecione...", "SD", "CB" }));
        jPanel4.add(posto_graduacao_controle_saida, new org.netbeans.lib.awtextra.AbsoluteConstraints(16, 47, 87, -1));

        jLabel11.setText("Posto/Graduação:");
        jPanel4.add(jLabel11, new org.netbeans.lib.awtextra.AbsoluteConstraints(16, 27, -1, -1));

        jLabel12.setText("Nome de Guerra:");
        jPanel4.add(jLabel12, new org.netbeans.lib.awtextra.AbsoluteConstraints(113, 27, -1, -1));
        jPanel4.add(nome_guerra_controle_saida, new org.netbeans.lib.awtextra.AbsoluteConstraints(113, 47, 155, -1));

        jLabel13.setText("Seção:");
        jPanel4.add(jLabel13, new org.netbeans.lib.awtextra.AbsoluteConstraints(16, 78, -1, -1));

        sessao_controle_saida.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Selecione...", "Administrativa", "Produção", "Expedição", "Pessoal", "Direção", "Orçamentação", "Pré-impressão" }));
        jPanel4.add(sessao_controle_saida, new org.netbeans.lib.awtextra.AbsoluteConstraints(16, 98, 252, -1));

        jLabel14.setText("Motivo de Saída:");
        jPanel4.add(jLabel14, new org.netbeans.lib.awtextra.AbsoluteConstraints(16, 129, -1, -1));
        jPanel4.add(motivo_controle_saida, new org.netbeans.lib.awtextra.AbsoluteConstraints(16, 149, 252, -1));

        jPanel8.setBorder(new javax.swing.border.SoftBevelBorder(javax.swing.border.BevelBorder.RAISED));

        foto_controle_saida.setBackground(new java.awt.Color(0, 0, 0));
        foto_controle_saida.setOpaque(true);

        javax.swing.GroupLayout jPanel8Layout = new javax.swing.GroupLayout(jPanel8);
        jPanel8.setLayout(jPanel8Layout);
        jPanel8Layout.setHorizontalGroup(
            jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel8Layout.createSequentialGroup()
                .addGap(0, 0, Short.MAX_VALUE)
                .addComponent(foto_controle_saida, javax.swing.GroupLayout.PREFERRED_SIZE, 261, javax.swing.GroupLayout.PREFERRED_SIZE))
        );
        jPanel8Layout.setVerticalGroup(
            jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel8Layout.createSequentialGroup()
                .addGap(0, 0, Short.MAX_VALUE)
                .addComponent(foto_controle_saida, javax.swing.GroupLayout.PREFERRED_SIZE, 234, javax.swing.GroupLayout.PREFERRED_SIZE))
        );

        jPanel4.add(jPanel8, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 210, -1, -1));

        iniciar_video_controle_saida.setText("Iniciar Vídeo");
        iniciar_video_controle_saida.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                iniciar_video_controle_saidaActionPerformed(evt);
            }
        });
        jPanel4.add(iniciar_video_controle_saida, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 450, 130, -1));

        capturar_video_controle_saida.setText("Capturar Foto");
        capturar_video_controle_saida.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                capturar_video_controle_saidaActionPerformed(evt);
            }
        });
        jPanel4.add(capturar_video_controle_saida, new org.netbeans.lib.awtextra.AbsoluteConstraints(150, 450, 130, -1));

        novo_saida.setText("Novo");
        novo_saida.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                novo_saidaActionPerformed(evt);
            }
        });
        jPanel4.add(novo_saida, new org.netbeans.lib.awtextra.AbsoluteConstraints(30, 480, -1, -1));

        redefinir_saida.setText("Redefinir");
        redefinir_saida.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                redefinir_saidaActionPerformed(evt);
            }
        });
        jPanel4.add(redefinir_saida, new org.netbeans.lib.awtextra.AbsoluteConstraints(90, 480, -1, -1));

        cadastrar_saida.setText("Cadastrar");
        cadastrar_saida.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cadastrar_saidaActionPerformed(evt);
            }
        });
        jPanel4.add(cadastrar_saida, new org.netbeans.lib.awtextra.AbsoluteConstraints(170, 480, -1, -1));

        controle_tabela_saida.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "ID", "Posto/Grad", "Nome de Guerra", "Sessão", "Data", "Horário Saída", "Horário Entrada", "Motivo Saída"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false, false, false, false, false, true, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        controle_tabela_saida.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                controle_tabela_saidaMouseClicked(evt);
            }
        });
        jScrollPane2.setViewportView(controle_tabela_saida);

        pesquisa_controle_saida.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                pesquisa_controle_saidaActionPerformed(evt);
            }
        });
        pesquisa_controle_saida.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                pesquisa_controle_saidaKeyReleased(evt);
            }
        });

        sair_controle.setText("Sair");
        sair_controle.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                sair_controleActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addGap(110, 110, 110)
                .addComponent(jLabel9)
                .addGap(0, 0, Short.MAX_VALUE))
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addGap(7, 7, 7)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel15)
                    .addComponent(pesquisa_controle_saida, javax.swing.GroupLayout.PREFERRED_SIZE, 290, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jPanel4, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addComponent(jScrollPane2)
                        .addGap(10, 10, 10))
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel2Layout.createSequentialGroup()
                        .addComponent(def_horario_entrada_controle, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addContainerGap())
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel2Layout.createSequentialGroup()
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 679, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(ferramentas_adm_controle_saida)
                                .addGap(3, 3, 3)
                                .addComponent(sair_controle))
                            .addComponent(jScrollPane6, javax.swing.GroupLayout.DEFAULT_SIZE, 1277, Short.MAX_VALUE))
                        .addContainerGap())))
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel2Layout.createSequentialGroup()
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addGap(10, 10, 10)
                        .addComponent(jLabel9)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(jScrollPane2, javax.swing.GroupLayout.PREFERRED_SIZE, 442, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(def_horario_entrada_controle, javax.swing.GroupLayout.PREFERRED_SIZE, 33, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(18, 18, 18)
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(ferramentas_adm_controle_saida)
                            .addComponent(sair_controle))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jScrollPane6, javax.swing.GroupLayout.PREFERRED_SIZE, 77, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addContainerGap()
                        .addComponent(jLabel15)
                        .addGap(6, 6, 6)
                        .addComponent(pesquisa_controle_saida, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jPanel4, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
                .addGap(179, 179, 179))
        );

        jTabbedPane1.addTab("Controle de saída de CB/SD", jPanel2);

        jPanel7.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jPanel7MouseClicked(evt);
            }
        });

        jLabel16.setText("Procurar por nome de guerra:");

        def_horario_saida_entrada.setText("Definir Horário de Saída");
        def_horario_saida_entrada.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                def_horario_saida_entradaActionPerformed(evt);
            }
        });

        jScrollPane7.setViewportView(txt_info3);

        ferramentas_adm_controle_entrada.setText("Ferramentas de Administrador");
        ferramentas_adm_controle_entrada.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                ferramentas_adm_controle_entradaActionPerformed(evt);
            }
        });

        jPanel9.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Registro", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 11))); // NOI18N
        jPanel9.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        lista_pesquisa_controle_entrada.setBorder(new javax.swing.border.SoftBevelBorder(javax.swing.border.BevelBorder.RAISED));
        lista_pesquisa_controle_entrada.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                lista_pesquisa_controle_entradaMouseClicked(evt);
            }
        });
        jPanel9.add(lista_pesquisa_controle_entrada, new org.netbeans.lib.awtextra.AbsoluteConstraints(0, 0, 290, 90));

        posto_graduacao_controle_entrada.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Selecione...", "SD", "CB", "SGT", "ST", "TEN", "CAP", "MAJ", "TC" }));
        jPanel9.add(posto_graduacao_controle_entrada, new org.netbeans.lib.awtextra.AbsoluteConstraints(16, 47, 87, -1));

        jLabel18.setText("Posto/Graduação:");
        jPanel9.add(jLabel18, new org.netbeans.lib.awtextra.AbsoluteConstraints(16, 27, -1, -1));

        jLabel19.setText("Nome de Guerra:");
        jPanel9.add(jLabel19, new org.netbeans.lib.awtextra.AbsoluteConstraints(113, 27, -1, -1));
        jPanel9.add(nome_guerra_controle_entrada, new org.netbeans.lib.awtextra.AbsoluteConstraints(113, 47, 155, -1));

        jLabel20.setText("Seção:");
        jPanel9.add(jLabel20, new org.netbeans.lib.awtextra.AbsoluteConstraints(16, 78, -1, -1));

        sessao_controle_entrada.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Selecione...", "Administrativa", "Produção", "Expedição", "Pessoal", "Direção", "Orçamentação", "Pré-impressão" }));
        jPanel9.add(sessao_controle_entrada, new org.netbeans.lib.awtextra.AbsoluteConstraints(16, 98, 252, -1));

        jLabel21.setText("Motivo de Entrada:");
        jPanel9.add(jLabel21, new org.netbeans.lib.awtextra.AbsoluteConstraints(16, 129, -1, -1));
        jPanel9.add(motivo_controle_entrada, new org.netbeans.lib.awtextra.AbsoluteConstraints(16, 149, 252, -1));

        jPanel10.setBorder(new javax.swing.border.SoftBevelBorder(javax.swing.border.BevelBorder.RAISED));

        foto_controle_entrada.setBackground(new java.awt.Color(0, 0, 0));
        foto_controle_entrada.setOpaque(true);

        javax.swing.GroupLayout jPanel10Layout = new javax.swing.GroupLayout(jPanel10);
        jPanel10.setLayout(jPanel10Layout);
        jPanel10Layout.setHorizontalGroup(
            jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel10Layout.createSequentialGroup()
                .addGap(0, 0, Short.MAX_VALUE)
                .addComponent(foto_controle_entrada, javax.swing.GroupLayout.PREFERRED_SIZE, 261, javax.swing.GroupLayout.PREFERRED_SIZE))
        );
        jPanel10Layout.setVerticalGroup(
            jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel10Layout.createSequentialGroup()
                .addGap(0, 0, Short.MAX_VALUE)
                .addComponent(foto_controle_entrada, javax.swing.GroupLayout.PREFERRED_SIZE, 234, javax.swing.GroupLayout.PREFERRED_SIZE))
        );

        jPanel9.add(jPanel10, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 210, -1, -1));

        iniciar_video_controle_entrada.setText("Iniciar Vídeo");
        iniciar_video_controle_entrada.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                iniciar_video_controle_entradaActionPerformed(evt);
            }
        });
        jPanel9.add(iniciar_video_controle_entrada, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 450, 120, -1));

        capturar_video_controle_entrada.setText("Capturar Foto");
        capturar_video_controle_entrada.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                capturar_video_controle_entradaActionPerformed(evt);
            }
        });
        jPanel9.add(capturar_video_controle_entrada, new org.netbeans.lib.awtextra.AbsoluteConstraints(160, 450, 120, -1));

        novo_entrada.setText("Novo");
        novo_entrada.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                novo_entradaActionPerformed(evt);
            }
        });
        jPanel9.add(novo_entrada, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 480, -1, -1));

        redefinir_entrada.setText("Redefinir");
        redefinir_entrada.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                redefinir_entradaActionPerformed(evt);
            }
        });
        jPanel9.add(redefinir_entrada, new org.netbeans.lib.awtextra.AbsoluteConstraints(90, 480, -1, -1));

        cadastrar_entrada.setText("Cadastrar");
        cadastrar_entrada.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cadastrar_entradaActionPerformed(evt);
            }
        });
        jPanel9.add(cadastrar_entrada, new org.netbeans.lib.awtextra.AbsoluteConstraints(170, 480, -1, -1));

        controle_tabela_saida1.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "ID", "Posto/Grad", "Nome de Guerra", "Sessão", "Data", "Horário Entrada", "Horário Saída", "Motivo Saída"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false, false, false, false, false, false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        controle_tabela_saida1.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                controle_tabela_saida1MouseClicked(evt);
            }
        });
        jScrollPane4.setViewportView(controle_tabela_saida1);

        pesquisa_controle_entrada.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                pesquisa_controle_entradaActionPerformed(evt);
            }
        });
        pesquisa_controle_entrada.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                pesquisa_controle_entradaKeyReleased(evt);
            }
        });

        sair_controle1.setText("Sair");
        sair_controle1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                sair_controle1ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel7Layout = new javax.swing.GroupLayout(jPanel7);
        jPanel7.setLayout(jPanel7Layout);
        jPanel7Layout.setHorizontalGroup(
            jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel7Layout.createSequentialGroup()
                .addGap(9, 9, 9)
                .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel16)
                    .addComponent(pesquisa_controle_entrada, javax.swing.GroupLayout.PREFERRED_SIZE, 290, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jPanel9, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel7Layout.createSequentialGroup()
                        .addComponent(jScrollPane4)
                        .addGap(13, 13, 13))
                    .addGroup(jPanel7Layout.createSequentialGroup()
                        .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel7Layout.createSequentialGroup()
                                .addGap(10, 10, 10)
                                .addComponent(jScrollPane7, javax.swing.GroupLayout.DEFAULT_SIZE, 1265, Short.MAX_VALUE))
                            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel7Layout.createSequentialGroup()
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 674, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(ferramentas_adm_controle_entrada)
                                .addGap(6, 6, 6)
                                .addComponent(sair_controle1)))
                        .addContainerGap())
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel7Layout.createSequentialGroup()
                        .addComponent(def_horario_saida_entrada, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addContainerGap())))
        );
        jPanel7Layout.setVerticalGroup(
            jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel7Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel7Layout.createSequentialGroup()
                        .addGap(0, 0, Short.MAX_VALUE)
                        .addComponent(jScrollPane4, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(8, 8, 8)
                        .addComponent(def_horario_saida_entrada, javax.swing.GroupLayout.PREFERRED_SIZE, 40, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(33, 33, 33)
                        .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(ferramentas_adm_controle_entrada)
                            .addComponent(sair_controle1))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(jScrollPane7, javax.swing.GroupLayout.PREFERRED_SIZE, 63, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(jPanel7Layout.createSequentialGroup()
                        .addComponent(jLabel16)
                        .addGap(6, 6, 6)
                        .addComponent(pesquisa_controle_entrada, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jPanel9, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
                .addGap(183, 183, 183))
        );

        jTabbedPane1.addTab("Controle de Entrada Fora do Expediente de Militares", jPanel7);

        getContentPane().add(jTabbedPane1);

        setBounds(0, 0, 1622, 857);
    }// </editor-fold>//GEN-END:initComponents

    private void def_horario_entrada_controleActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_def_horario_entrada_controleActionPerformed
        try{
            SimpleDateFormat sdh = new SimpleDateFormat("HH:mm:ss");
            SimpleDateFormat sdf = new SimpleDateFormat("dd/MM/yyyy");
            int l = controle_tabela_saida.getSelectedRow();
            ControleExpedienteBEAN c = new ControleExpedienteBEAN();
            controleDAO cdao = new controleDAO();
            c.setHora_entrada(sdh.format(new Date()));
            c.setId((int)controle_tabela_saida.getValueAt(l, 0));
            cdao.altera_controle(c);
            readJTable_controle();
            def_horario_entrada_controle.setEnabled(false);
            txt_info2.setText("Dispositivo de vídeo:" + Webcam.getDefault().toString() + "  -- Data e hora da útima atualização:" + sdf.format(new Date()) + " " + sdh.format(new Date()));
        }catch(SQLException ex){
            System.err.println("Erro na atualização!"+ex);
        }

    }//GEN-LAST:event_def_horario_entrada_controleActionPerformed

    private void ferramentas_adm_controle_saidaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_ferramentas_adm_controle_saidaActionPerformed
        Login login = new Login();
        login.setDefaultCloseOperation(login.DISPOSE_ON_CLOSE);
        login.setLocationRelativeTo(null);
        login.setVisible(true);
    }//GEN-LAST:event_ferramentas_adm_controle_saidaActionPerformed

    private void iniciar_video_controle_saidaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_iniciar_video_controle_saidaActionPerformed
        new Thread(){
            public void run(){
                executando = true;
                foto_controle_saida.setText("Iniciando...");
                WEBCAM.open();
                foto_controle_saida.setText("");
                INICIALIZA_VIDEO(foto_controle_saida);
                capturar_video_controle_saida.setEnabled(true);
            }
        }.start();
    }//GEN-LAST:event_iniciar_video_controle_saidaActionPerformed

    private void capturar_video_controle_saidaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_capturar_video_controle_saidaActionPerformed
        

        new Thread(){
            public void run(){
                WEBCAM.close();
                executando = false;
                capturar_video_controle_saida.setEnabled(false);
            }
        }.start();
    }//GEN-LAST:event_capturar_video_controle_saidaActionPerformed

    private void novo_saidaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_novo_saidaActionPerformed
        redefinir_saida.setEnabled(false);
        cadastrar_saida.setEnabled(true);
        novo_saida.setEnabled(false);
        nome_guerra_controle_saida.setEnabled(true);
        sessao_controle_saida.setEnabled(true);
        posto_graduacao_controle_saida.setEnabled(true);
        motivo_controle_saida.setEnabled(true);
        capturar_video_controle_saida.setEnabled(false);
        def_horario_entrada_controle.setEnabled(false);

        nome_guerra_controle_saida.setText("");
        sessao_controle_saida.setSelectedIndex(0);
        posto_graduacao_controle_saida.setSelectedIndex(0);
        motivo_controle_saida.setText("");
    }//GEN-LAST:event_novo_saidaActionPerformed

    private void redefinir_saidaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_redefinir_saidaActionPerformed
        red_controle = 1;
        redefinir_saida.setEnabled(false);
        cadastrar_saida.setEnabled(true);
        novo_saida.setEnabled(true);
        nome_guerra_controle_saida.setEnabled(false);
        sessao_controle_saida.setEnabled(false);
        posto_graduacao_controle_saida.setEnabled(false);
        motivo_controle_saida.setEnabled(true);
        capturar_video_controle_saida.setEnabled(false);
        def_horario_entrada_controle.setEnabled(false);
        motivo_controle_saida.setText("");
    }//GEN-LAST:event_redefinir_saidaActionPerformed

    private void cadastrar_saidaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cadastrar_saidaActionPerformed
        SimpleDateFormat sdf = new SimpleDateFormat("dd/MM/yyyy");
        SimpleDateFormat sdh = new SimpleDateFormat("HH:mm:ss");
        Date data = new Date();
        controleDAO cdao = new controleDAO();
        ControleExpedienteBEAN c = new ControleExpedienteBEAN();
        String posto;
        String sessao;
        posto = (String) posto_graduacao_controle_saida.getSelectedItem();
        sessao = (String) sessao_controle_saida.getSelectedItem();
        String hora_saida;
        String aux;
        int hora;
        int minuto;
        
        try {
            if(cdao.busca_nome_controle(posto_graduacao_controle_saida.getSelectedItem().toString(),nome_guerra_controle_saida.getText().toUpperCase())==true && red_controle == 0){
                JOptionPane.showMessageDialog(null,"O Sr.(a) " + posto_graduacao_controle_saida.getSelectedItem().toString() + " " + nome_guerra_controle_saida.getText().toUpperCase() + " já existe no banco de dados!\n Por favor utilize o campo de busca ou digite outro nome.");
                imageArray_controle = null;
                foto_controle_saida.setIcon(null);
                redefinir_saida.setEnabled(false);
                cadastrar_saida.setEnabled(false);
                novo_saida.setEnabled(true);
                nome_guerra_controle_saida.setEnabled(false);
                sessao_controle_saida.setEnabled(false);
                posto_graduacao_controle_saida.setEnabled(false);
                motivo_controle_saida.setEnabled(false);
                capturar_video_controle_saida.setEnabled(false);
                def_horario_entrada_controle.setEnabled(false);

                nome_guerra_controle_saida.setText("");
                sessao_controle_saida.setSelectedIndex(0);
                posto_graduacao_controle_saida.setSelectedIndex(0);
                motivo_controle_saida.setText("");
                red_controle = 0;
                return;
            }if(nome_guerra_controle_saida.getText().equals("")){
                JOptionPane.showMessageDialog(null,"O campo 'Nome de guerra' não pode ser vazio!");
                return;
            }else{
                c.setNome_guerra(nome_guerra_controle_saida.getText().toUpperCase());
            }
        } catch (SQLException ex) {
            Logger.getLogger(Cadastro.class.getName()).log(Level.SEVERE, null, ex);
        }

        if(posto.equals("Selecione...")){
            JOptionPane.showMessageDialog(null,"O campo 'Posto/Graduação' não pode ser vazio!");
            return;
        }else{
            c.setGrad_posto(posto);
        }

        if(sessao.equals("Selecione...")){
            JOptionPane.showMessageDialog(null,"O campo 'Sessão' não pode ser vazio!");
            return;
        }else{
            c.setSessao(sessao);
        }

        hora_saida = sdh.format(new Date());
        aux = hora_saida.substring(0,2) + hora_saida.substring(3,5);
        hora = Integer.parseInt(String.valueOf(aux));
        Calendar cal = Calendar.getInstance();
        cal.setTime(data);
        System.out.println(hora);
        int day = cal.get(Calendar.DAY_OF_WEEK);
        if((hora >= 900 & hora <= 1700) & day != 6 & day != 7 & day != 1 ) {
            c.setData(sdf.format(new Date()));
            c.setHora_saida(sdh.format(new Date()));
            c.setHora_entrada("");
        }else if((day == 6) & (hora >= 800 & hora <= 1200)){
            c.setData(sdf.format(new Date()));
            c.setHora_saida(sdh.format(new Date()));
            c.setHora_entrada("");
        }else{
            JOptionPane.showMessageDialog(null, "Registro fora do horário de expediente.\n");
            imageArray_controle = null;
            foto_controle_saida.setIcon(null);
            redefinir_saida.setEnabled(false);
            cadastrar_saida.setEnabled(false);
            novo_saida.setEnabled(true);
            nome_guerra_controle_saida.setEnabled(false);
            sessao_controle_saida.setEnabled(false);
            posto_graduacao_controle_saida.setEnabled(false);
            motivo_controle_saida.setEnabled(false);
            capturar_video_controle_saida.setEnabled(false);
            def_horario_entrada_controle.setEnabled(false);

            nome_guerra_controle_saida.setText("");
            sessao_controle_saida.setSelectedIndex(0);
            posto_graduacao_controle_saida.setSelectedIndex(0);
            motivo_controle_saida.setText("");
            red_controle = 0;
            return;
        }
        
        if(motivo_controle_saida.getText().equals("")){
            JOptionPane.showMessageDialog(null,"O campo 'Motivo' não pode ser vazio!");
            return;
        }else{
            c.setMotivo_saida(motivo_controle_saida.getText().toUpperCase());
        }

        if(imageArray_controle == null && webcam_found == true){
            JOptionPane.showMessageDialog(null,"Não foi capturada uma imagem do usuário!");
            return;
        }else if(webcam_found == true){
            try {
                c.setImagem(getImgBytes(imageArray_controle));
            } catch (IOException ex) {

            }

        }else{
            JOptionPane.showMessageDialog(null,"Favor procure um dispositivo de video!\n O registro foi salvo sem imagem!");
        }

        cdao.create(c);
        readJTable_controle();
        //readJTable();
        imageArray_controle = null;
        foto_controle_saida.setIcon(null);

        redefinir_saida.setEnabled(false);
        cadastrar_saida.setEnabled(false);
        novo_saida.setEnabled(true);
        nome_guerra_controle_saida.setEnabled(false);
        sessao_controle_saida.setEnabled(false);
        posto_graduacao_controle_saida.setEnabled(false);
        motivo_controle_saida.setEnabled(false);
        capturar_video_controle_saida.setEnabled(false);
        def_horario_entrada_controle.setEnabled(false);

        nome_guerra_controle_saida.setText("");
        sessao_controle_saida.setSelectedIndex(0);
        posto_graduacao_controle_saida.setSelectedIndex(0);
        motivo_controle_saida.setText("");
        red_controle = 0;
        
        if(webcam_found = true){
            txt_info2.setText("Dispositivo de vídeo:" + Webcam.getDefault().toString() + "  -- Data e hora da útima atualização:" + sdf.format(new Date()) + " " + sdh.format(new Date())+ 
                    "\n\nObservações: O registro de saída de CB/SD só deve ser feito durante o horário de expediente;"
                    + "\nCaso o expediente acabe e o militar não tenha retornado, o horário de entrada deve ficar em branco;"
                    + "\nSempre ao adicionar um novo registro preste atenção ao preenchimento correto dos campos.");
        }else{
            txt_info2.setText("Dispositivo de vídeo: Nenhum" + "  -- Data e hora da útima atualização:" + sdf.format(new Date()) + " " + sdh.format(new Date())+ 
                    "\n\nObservações: O registro de saída de CB/SD só deve ser feito durante o horário de expediente;"
                    + "\nCaso o expediente acabe e o militar não tenha retornado, o horário de entrada deve ficar em branco;"
                    + "\nSempre ao adicionar um novo registro preste atenção ao preenchimento correto dos campos.");
        }
        
    }//GEN-LAST:event_cadastrar_saidaActionPerformed

    private void lista_pesquisa_controle_saidaMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_lista_pesquisa_controle_saidaMouseClicked
        try {
            String selected = lista_pesquisa_controle_saida.getSelectedValue().toString();
            int id = selected.indexOf(" ");
            String grad_posto = selected.substring(0,id);
            String nome_guerra = selected.substring(id+1);
            ResultadoPesquisa_controle(grad_posto, nome_guerra);
        } catch (SQLException ex) {
            System.err.println("Erro1");
        } catch (IOException ex) {
            System.err.println("Erro2");
        }
        redefinir_saida.setEnabled(true);
        cadastrar_saida.setEnabled(false);
        novo_saida.setEnabled(true);
        nome_guerra_controle_saida.setEnabled(false);
        sessao_controle_saida.setEnabled(false);
        posto_graduacao_controle_saida.setEnabled(false);
        capturar_video_controle_saida.setEnabled(false);
        motivo_controle_saida.setEnabled(false);
    }//GEN-LAST:event_lista_pesquisa_controle_saidaMouseClicked

    private void controle_tabela_saidaMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_controle_tabela_saidaMouseClicked
        try {
            Integer id2 = (Integer) controle_tabela_saida.getValueAt(controle_tabela_saida.getSelectedRow(),0);
            controleDAO cdao = new controleDAO();
            if(controle_tabela_saida.getValueAt(controle_tabela_saida.getSelectedRow(), 6).equals("")){
                def_horario_entrada_controle.setEnabled(true);
            }else{
                def_horario_entrada_controle.setEnabled(false);
            }
            ControleExpedienteBEAN retorno = cdao.buscaImg_controle(id2);
            exibirImagemLabel(retorno.getImagem(),foto_controle_saida);
        } catch (SQLException ex) {
            Logger.getLogger(Cadastro.class.getName()).log(Level.SEVERE, null, ex);
        }
    }//GEN-LAST:event_controle_tabela_saidaMouseClicked

    private void pesquisa_controle_saidaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_pesquisa_controle_saidaActionPerformed
        lista_pesquisa_controle_saida.setVisible(false);
    }//GEN-LAST:event_pesquisa_controle_saidaActionPerformed

    private void pesquisa_controle_saidaKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_pesquisa_controle_saidaKeyReleased
        try {
            ListaDePesquisa_controle();
        } catch (SQLException ex) {
            Logger.getLogger(Cadastro.class.getName()).log(Level.SEVERE, null, ex);
        }
    }//GEN-LAST:event_pesquisa_controle_saidaKeyReleased

    private void sair_controleActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_sair_controleActionPerformed
        System.exit(0);
    }//GEN-LAST:event_sair_controleActionPerformed

    private void def_horario_saida_entradaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_def_horario_saida_entradaActionPerformed
        try{
            SimpleDateFormat sdh = new SimpleDateFormat("HH:mm:ss");
            SimpleDateFormat sdf = new SimpleDateFormat("dd/MM/yyyy");
            int l = controle_tabela_saida1.getSelectedRow();
            ControleForaExpedienteBEAN cf = new ControleForaExpedienteBEAN();
            controlefDAO cfdao = new controlefDAO();
            cf.setHora_saida(sdh.format(new Date()));
            cf.setId((int)controle_tabela_saida1.getValueAt(l, 0));
            cfdao.altera_controlef(cf);
            readJTable_controlef();
            def_horario_saida_entrada.setEnabled(false);
            txt_info3.setText("Dispositivo de vídeo:" + Webcam.getDefault().toString() + "  -- Data e hora da útima atualização:" + sdf.format(new Date()) + " " + sdh.format(new Date()));
        }catch(SQLException ex){
            System.err.println("Erro na atualização!"+ex);
        }
    }//GEN-LAST:event_def_horario_saida_entradaActionPerformed

    private void ferramentas_adm_controle_entradaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_ferramentas_adm_controle_entradaActionPerformed
        Login login = new Login();
        login.setDefaultCloseOperation(login.DISPOSE_ON_CLOSE);
        login.setLocationRelativeTo(null);
        login.setVisible(true);
    }//GEN-LAST:event_ferramentas_adm_controle_entradaActionPerformed

    private void lista_pesquisa_controle_entradaMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_lista_pesquisa_controle_entradaMouseClicked
        try {
            String selected = lista_pesquisa_controle_entrada.getSelectedValue().toString();
            int id = selected.indexOf(" ");
            String grad_posto = selected.substring(0,id);
            String nome_guerra = selected.substring(id+1);
            ResultadoPesquisa_controlef(grad_posto, nome_guerra);
        }catch (IOException ex) {
            Logger.getLogger(Cadastro.class.getName()).log(Level.SEVERE, null, ex);
        }
        redefinir_entrada.setEnabled(true);
        cadastrar_entrada.setEnabled(false);
        novo_entrada.setEnabled(true);
        nome_guerra_controle_entrada.setEnabled(false);
        sessao_controle_entrada.setEnabled(false);
        posto_graduacao_controle_entrada.setEnabled(false);
        capturar_video_controle_entrada.setEnabled(false);
        motivo_controle_entrada.setEnabled(false);
    }//GEN-LAST:event_lista_pesquisa_controle_entradaMouseClicked

    private void iniciar_video_controle_entradaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_iniciar_video_controle_entradaActionPerformed
        new Thread(){
            public void run(){
                executando = true;
                foto_controle_entrada.setText("Iniciando...");
                WEBCAM.open();
                foto_controle_entrada.setText("");
                INICIALIZA_VIDEO(foto_controle_entrada);
                capturar_video_controle_entrada.setEnabled(true);
            }
        }.start();
    }//GEN-LAST:event_iniciar_video_controle_entradaActionPerformed

    private void capturar_video_controle_entradaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_capturar_video_controle_entradaActionPerformed
        
        new Thread(){
            public void run(){
                WEBCAM.close();
                executando = false;
                capturar_video_controle_entrada.setEnabled(false);
            }
        }.start();
    }//GEN-LAST:event_capturar_video_controle_entradaActionPerformed

    private void novo_entradaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_novo_entradaActionPerformed
        redefinir_entrada.setEnabled(false);
        cadastrar_entrada.setEnabled(true);
        novo_entrada.setEnabled(false);
        nome_guerra_controle_entrada.setEnabled(true);
        sessao_controle_entrada.setEnabled(true);
        posto_graduacao_controle_entrada.setEnabled(true);
        motivo_controle_entrada.setEnabled(true);
        capturar_video_controle_entrada.setEnabled(false);
        def_horario_saida_entrada.setEnabled(false);

        nome_guerra_controle_entrada.setText("");
        sessao_controle_entrada.setSelectedIndex(0);
        posto_graduacao_controle_entrada.setSelectedIndex(0);
        motivo_controle_entrada.setText("");
    }//GEN-LAST:event_novo_entradaActionPerformed

    private void redefinir_entradaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_redefinir_entradaActionPerformed
        red_controlef = 1;
        redefinir_entrada.setEnabled(false);
        cadastrar_entrada.setEnabled(true);
        novo_entrada.setEnabled(true);
        nome_guerra_controle_entrada.setEnabled(false);
        sessao_controle_entrada.setEnabled(false);
        posto_graduacao_controle_entrada.setEnabled(false);
        motivo_controle_entrada.setEnabled(true);
        capturar_video_controle_entrada.setEnabled(false);
        def_horario_saida_entrada.setEnabled(false);
        motivo_controle_entrada.setText("");
    }//GEN-LAST:event_redefinir_entradaActionPerformed

    private void cadastrar_entradaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cadastrar_entradaActionPerformed
        SimpleDateFormat sdf = new SimpleDateFormat("dd/MM/yyyy");
        SimpleDateFormat sdh = new SimpleDateFormat("HH:mm:ss");
        
        controlefDAO cfdao = new controlefDAO();
        ControleForaExpedienteBEAN cf = new ControleForaExpedienteBEAN();
        String posto;
        String sessao;
        posto = (String) posto_graduacao_controle_entrada.getSelectedItem();
        sessao = (String) sessao_controle_entrada.getSelectedItem();
        String hora_saida;
        String aux;
        int hora;
        int minuto;
        
        try {
            if(cfdao.busca_nome_controlef(posto_graduacao_controle_entrada.getSelectedItem().toString(), nome_guerra_controle_entrada.getText().toUpperCase()) == true && red_controlef == 0){
                JOptionPane.showMessageDialog(null,"O Sr.(a) " + posto_graduacao_controle_entrada.getSelectedItem().toString() + " " + nome_guerra_controle_entrada.getText() + " já existe no banco de dados!\n Por favor utilize o campo de busca ou digite outro nome.");
                return;
            }if(nome_guerra_controle_entrada.getText().equals("")){
                JOptionPane.showMessageDialog(null,"O campo 'Nome de guerra' não pode ser vazio!");
                return;
            }else{
                cf.setNome_guerra(nome_guerra_controle_entrada.getText().toUpperCase());
            }
        } catch (SQLException ex) {
            Logger.getLogger(Cadastro.class.getName()).log(Level.SEVERE, null, ex);
        }

        if(posto.equals("Selecione...")){
            JOptionPane.showMessageDialog(null,"O campo 'Posto/Graduação' não pode ser vazio!");
            return;
        }else{
            cf.setGrad_posto(posto);
        }

        if(sessao.equals("Selecione...")){
            JOptionPane.showMessageDialog(null,"O campo 'Sessão' não pode ser vazio!");
            return;
        }else{
            cf.setSessao(sessao);
        }
        
        if(motivo_controle_entrada.getText().equals("")){
            JOptionPane.showMessageDialog(null,"O campo 'Motivo de Entrada' não pode ser vazio!");
            return;
        }else{
            cf.setMotivo_entrada(motivo_controle_entrada.getText().toUpperCase());
        }

        if(imageArray_controlef == null && webcam_found == true){
            JOptionPane.showMessageDialog(null,"Não foi capturada uma imagem do usuário!");
            return;
        }else if(webcam_found == true){
            try {
                cf.setImagem(getImgBytes(imageArray_controlef));
            } catch (IOException ex) {

            }

        }else{
            JOptionPane.showMessageDialog(null,"Favor procure um dispositivo de video!\n O registro foi salvo sem imagem!");
        }
        
        cf.setData(sdf.format(new Date()));
        cf.setHora_entrada(sdh.format(new Date()));
        cf.setHora_saida("");

        cfdao.create(cf);
        readJTable_controlef();
        imageArray_controlef = null;
        foto_controle_entrada.setIcon(null);

        redefinir_entrada.setEnabled(false);
        cadastrar_entrada.setEnabled(false);
        novo_entrada.setEnabled(true);
        nome_guerra_controle_entrada.setEnabled(false);
        sessao_controle_entrada.setEnabled(false);
        posto_graduacao_controle_entrada.setEnabled(false);
        motivo_controle_entrada.setEnabled(false);
        capturar_video_controle_entrada.setEnabled(false);
        def_horario_saida_entrada.setEnabled(false);

        nome_guerra_controle_entrada.setText("");
        sessao_controle_entrada.setSelectedIndex(0);
        posto_graduacao_controle_entrada.setSelectedIndex(0);
        motivo_controle_entrada.setText("");
        red_controlef = 0;
        
        if(webcam_found = true){
            txt_info3.setText("Dispositivo de vídeo:" + Webcam.getDefault().toString() + 
                "  -- Data e hora da útima atualização:" + sdf.format(new Date()) + 
                " " + sdh.format(new Date()) + 
                "\n\nObservações: O registro fora do expediente só deve ser feito entre os horários:\n17h às 9h segunda a quarta/quinta\n17h às 8h quinta/sexta\nDurante todo o final de semana e feriados.");
        }else{
            txt_info3.setText("Dispositivo de vídeo: Nenhum"+ 
                "  -- Data e hora da útima atualização:" + sdf.format(new Date()) + 
                " " + sdh.format(new Date()) + 
                "\n\nObservações: O registro fora do expediente só deve ser feito entre os horários:\n17h às 9h segunda a quarta/quinta\n17h às 8h quinta/sexta\nDurante todo o final de semana e feriados.");
        }
        
    }//GEN-LAST:event_cadastrar_entradaActionPerformed

    private void controle_tabela_saida1MouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_controle_tabela_saida1MouseClicked
        try {
            Integer id2 = (Integer) controle_tabela_saida1.getValueAt(controle_tabela_saida1.getSelectedRow(),0);
            controlefDAO cfdao = new controlefDAO();
            if(controle_tabela_saida1.getValueAt(controle_tabela_saida1.getSelectedRow(), 6).equals("")){
                def_horario_saida_entrada.setEnabled(true);
            }else{
                def_horario_saida_entrada.setEnabled(false);
            }
            ControleForaExpedienteBEAN retorno = cfdao.buscaImg_controlef(id2);
            exibirImagemLabel(retorno.getImagem(),foto_controle_entrada);
        } catch (SQLException ex) {
            Logger.getLogger(Cadastro.class.getName()).log(Level.SEVERE, null, ex);
        }
    }//GEN-LAST:event_controle_tabela_saida1MouseClicked

    private void pesquisa_controle_entradaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_pesquisa_controle_entradaActionPerformed
        lista_pesquisa_controle_saida.setVisible(false);
    }//GEN-LAST:event_pesquisa_controle_entradaActionPerformed

    private void pesquisa_controle_entradaKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_pesquisa_controle_entradaKeyReleased
        ListaDePesquisa_controlef();
    }//GEN-LAST:event_pesquisa_controle_entradaKeyReleased

    private void sair_controle1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_sair_controle1ActionPerformed
        System.exit(0);
    }//GEN-LAST:event_sair_controle1ActionPerformed

    private void jPanel2MouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jPanel2MouseClicked
        lista_pesquisa_controle_saida.setVisible(false);
    }//GEN-LAST:event_jPanel2MouseClicked

    private void jPanel7MouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jPanel7MouseClicked
        lista_pesquisa_controle_entrada.setVisible(false);
    }//GEN-LAST:event_jPanel7MouseClicked

    private void jPanel1MouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jPanel1MouseClicked
        lista_pesquisa_registro_visitantes.setVisible(false);
    }//GEN-LAST:event_jPanel1MouseClicked

    private void associar_buttonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_associar_buttonActionPerformed
        VeiculosFrame vf = new VeiculosFrame();
        vf.setDefaultCloseOperation(vf.DISPOSE_ON_CLOSE);
        vf.setLocationRelativeTo(null);
        vf.setVisible(true);
    }//GEN-LAST:event_associar_buttonActionPerformed

    private void sair_buttonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_sair_buttonActionPerformed
        System.exit(0);
    }//GEN-LAST:event_sair_buttonActionPerformed

    private void c13ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_c13ActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_c13ActionPerformed

    private void c16ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_c16ActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_c16ActionPerformed

    private void c8ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_c8ActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_c8ActionPerformed

    private void c9ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_c9ActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_c9ActionPerformed

    private void c7ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_c7ActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_c7ActionPerformed

    private void c6ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_c6ActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_c6ActionPerformed

    private void c1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_c1ActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_c1ActionPerformed

    private void c10ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_c10ActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_c10ActionPerformed

    private void c5ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_c5ActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_c5ActionPerformed

    private void c3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_c3ActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_c3ActionPerformed

    private void c2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_c2ActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_c2ActionPerformed

    private void c4ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_c4ActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_c4ActionPerformed

    private void ferramentas_adm_visitanteActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_ferramentas_adm_visitanteActionPerformed
        Login login = new Login();
        login.setDefaultCloseOperation(login.DISPOSE_ON_CLOSE);
        login.setLocationRelativeTo(null);
        login.setVisible(true);
    }//GEN-LAST:event_ferramentas_adm_visitanteActionPerformed

    private void novo_visitanteActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_novo_visitanteActionPerformed
        try {
            verifica_check();
        } catch (SQLException ex) {
            Logger.getLogger(Cadastro.class.getName()).log(Level.SEVERE, null, ex);
        }
        executando = false;
        redefinir_visitante.setEnabled(false);
        cadastrar_visitante.setEnabled(true);
        nome_visitante.setEnabled(true);
        numero_doc_visitante.setEnabled(true);
        destino_visitante.setEnabled(true);
        com_quem_falar_visitante.setEnabled(true);
        telefone_visitante.setEnabled(true);
        Civil.setEnabled(true);
        Militar.setEnabled(true);
        Fornec.setEnabled(true);
        capturar_video_registro_visitantes.setEnabled(false);
        def_horario_saida_visitante.setEnabled(false);
        novo_visitante.setEnabled(false);
        tipo_doc_visitante.setEnabled(true);

        nome_visitante.setText("");
        numero_doc_visitante.setText("");
        destino_visitante.setText("");
        com_quem_falar_visitante.setText("");
        telefone_visitante.setText("");
        tipo_doc_visitante.setSelectedIndex(0);
        buttonGroup1.clearSelection();
    }//GEN-LAST:event_novo_visitanteActionPerformed

    private void destino_visitanteActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_destino_visitanteActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_destino_visitanteActionPerformed

    private void iniciar_video_registro_visitantesActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_iniciar_video_registro_visitantesActionPerformed
        new Thread(){
            public void run(){
                executando = true;
                foto_visitante.setText("Iniciando...");
                WEBCAM.open();
                foto_visitante.setText("");
                INICIALIZA_VIDEO(foto_visitante);
                capturar_video_registro_visitantes.setEnabled(true);
            }
        }.start();
    }//GEN-LAST:event_iniciar_video_registro_visitantesActionPerformed

    private void nome_visitanteActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_nome_visitanteActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_nome_visitanteActionPerformed

    private void def_horario_saida_visitanteActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_def_horario_saida_visitanteActionPerformed
        SimpleDateFormat sdh = new SimpleDateFormat("HH:mm:ss");
        SimpleDateFormat sdf = new SimpleDateFormat("dd/MM/yyyy");
        int cracha;
        int l = controle_tabela.getSelectedRow();
        CadastroBEAN c = new CadastroBEAN();
        cadastroDAO dao = new cadastroDAO();
        c.setHoraS(sdh.format(new Date()));
        c.setId((int)controle_tabela.getValueAt(l, 0));
        try {
            dao.altera(c);
        } catch (SQLException ex) {
            Logger.getLogger(Cadastro.class.getName()).log(Level.SEVERE, null, ex);
        }

        readJTable();
        def_horario_saida_visitante.setEnabled(false);
        txt_info.setText("Dispositivo de vídeo:" + Webcam.getDefault().toString() + "  -- Data e hora da útima atualização:" + sdf.format(new Date()) + " " + sdh.format(new Date()));
        try {
            verifica_check();
        } catch (SQLException ex) {
            Logger.getLogger(Cadastro.class.getName()).log(Level.SEVERE, null, ex);
        }
    }//GEN-LAST:event_def_horario_saida_visitanteActionPerformed

    private void controle_tabelaMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_controle_tabelaMouseClicked
        try {
            Integer id = (Integer) controle_tabela.getValueAt(controle_tabela.getSelectedRow(),0);
            cadastroDAO dao = new cadastroDAO();
            if(controle_tabela.getValueAt(controle_tabela.getSelectedRow(), 11) == null){
                def_horario_saida_visitante.setEnabled(true);
            }else{
                def_horario_saida_visitante.setEnabled(false);
            }
            CadastroBEAN retorno = dao.buscaImg(id);
            exibirImagemLabel(retorno.getFoto(),foto_visitante);
        } catch (SQLException ex) {
            System.err.println("Erro tableMouseClicked!");
        }
    }//GEN-LAST:event_controle_tabelaMouseClicked

    private void capturar_video_registro_visitantesActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_capturar_video_registro_visitantesActionPerformed
        try {
            ByteArrayOutputStream buff = new ByteArrayOutputStream();
            ImageIO.write(WEBCAM.getImage(), "JPEG", buff);
            byte[] bytes = buff.toByteArray();

            ByteArrayInputStream is = new ByteArrayInputStream(bytes);
            BufferedImage imagem = ImageIO.read(is);

            int nova_largura = foto_visitante.getWidth(), nova_altura = foto_visitante.getHeight();
            BufferedImage new_img = new BufferedImage(nova_largura, nova_altura, BufferedImage.TYPE_INT_RGB);
            Graphics2D g = new_img.createGraphics();
            g.drawImage(imagem,0,0,nova_largura,nova_altura,null);
            imageArray = new_img;
        } catch (IOException ex) {
            Logger.getLogger(Cadastro.class.getName()).log(Level.SEVERE, null, ex);
        }

        new Thread(){
            public void run(){
                WEBCAM.close();
                executando = false;
                capturar_video_registro_visitantes.setEnabled(false);
            }
        }.start();
    }//GEN-LAST:event_capturar_video_registro_visitantesActionPerformed

    private void redefinir_visitanteActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_redefinir_visitanteActionPerformed
        try {
            verifica_check();
        } catch (SQLException ex) {
            Logger.getLogger(Cadastro.class.getName()).log(Level.SEVERE, null, ex);
        }
        com_quem_falar_visitante.setEnabled(true);
        destino_visitante.setEnabled(true);
        redefinir_visitante.setEnabled(false);
        cadastrar_visitante.setEnabled(true);
        novo_visitante.setEnabled(true);
        red = 1;
    }//GEN-LAST:event_redefinir_visitanteActionPerformed

    private void cadastrar_visitanteActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cadastrar_visitanteActionPerformed
        SimpleDateFormat sdf = new SimpleDateFormat("dd/MM/yyyy");
        SimpleDateFormat sdh = new SimpleDateFormat("HH:mm:ss");
        CadastroBEAN c = new CadastroBEAN();
        cadastroDAO dao = new cadastroDAO();
        String tipo_doc = null;
        int cracha;

        try {
            if(dao.busca_nome(nome_visitante.getText().toUpperCase())==true && red == 0){
                JOptionPane.showMessageDialog(null,"O Sr.(a) " + nome_visitante.getText() + " já existe no banco de dados!\n Por favor utilize o campo de busca ou digite outro nome.");
                buttonGroup1.clearSelection();
                buttonGroup2.clearSelection();
                imageArray = null;
                foto_visitante.setIcon(null);
                redefinir_visitante.setEnabled(false);
                cadastrar_visitante.setEnabled(false);
                nome_visitante.setEnabled(false);
                numero_doc_visitante.setEnabled(false);
                destino_visitante.setEnabled(false);
                com_quem_falar_visitante.setEnabled(false);
                telefone_visitante.setEnabled(false);
                Civil.setEnabled(false);
                Militar.setEnabled(false);
                Fornec.setEnabled(false);
                tipo_doc_visitante.setEnabled(false);
                c1.setEnabled(false);
                c2.setEnabled(false);
                c3.setEnabled(false);
                c4.setEnabled(false);
                c5.setEnabled(false);
                c6.setEnabled(false);
                c7.setEnabled(false);
                c8.setEnabled(false);
                c9.setEnabled(false);
                c10.setEnabled(false);
                c11.setEnabled(false);
                c12.setEnabled(false);
                c13.setEnabled(false);
                c14.setEnabled(false);
                c15.setEnabled(false);
                c16.setEnabled(false);
                c17.setEnabled(false);
                c18.setEnabled(false);
                c19.setEnabled(false);
                c20.setEnabled(false);
                nome_visitante.setText("");
                numero_doc_visitante.setText("");
                destino_visitante.setText("");
                telefone_visitante.setText("");
                com_quem_falar_visitante.setText("");
                Civil.setSelected(false);
                Militar.setSelected(false);
                Fornec.setSelected(false);
                tipo_doc_visitante.setSelectedIndex(0);
                novo_visitante.setEnabled(true);
                red = 0;
                return;
            }if(nome_visitante.getText().equals("")){
                JOptionPane.showMessageDialog(null,"O campo 'Nome Completo' não pode ser vazio!");
                return;
            }else{
                c.setNomeCompleto(nome_visitante.getText().toUpperCase());
            }
        } catch (SQLException ex) {
            Logger.getLogger(Cadastro.class.getName()).log(Level.SEVERE, null, ex);
        }

        if(numero_doc_visitante.getText().equals("")){
            JOptionPane.showMessageDialog(null,"O campo 'Número Documento' não pode ser vazio!");
            return;
        }else{
            c.setDocumentoIden(numero_doc_visitante.getText());
        }

        if(destino_visitante.getText().equals("")){
            JOptionPane.showMessageDialog(null,"O campo 'Destino' não pode ser vazio!");
            return;
        }else{
            c.setDestino(destino_visitante.getText().toUpperCase());
        }

        if(com_quem_falar_visitante.getText().equals("")){
            JOptionPane.showMessageDialog(null,"O campo 'Com quem falar' não pode ser vazio!");
            return;
        }else{
            c.setComquemFalar(com_quem_falar_visitante.getText().toUpperCase());
        }

        if( telefone_visitante == null){
            JOptionPane.showMessageDialog(null,"O campo 'Telefone' não pode ser vazio!");
            return;
        }else{
            c.setTelefone(telefone_visitante.getText());
        }

        if(imageArray == null && webcam_found){
            JOptionPane.showMessageDialog(null,"Não foi capturada uma imagem do usuário!");
            return;
        }else if(webcam_found){
            try {
                c.setFoto(getImgBytes(imageArray));
            } catch (IOException ex) {
                Logger.getLogger(Cadastro.class.getName()).log(Level.SEVERE, null, ex);
            }
        }else{
            JOptionPane.showMessageDialog(null,"Favor procure um dispositivo de video!\n O registro foi salvo sem imagem!");
        }

        tipo_doc = (String) tipo_doc_visitante.getSelectedItem();
        if(tipo_doc.equals("Selecione...")){
            JOptionPane.showMessageDialog(null,"O campo 'Tipo Documento' não pode ser vazio!");
            return;
        }else{
            c.setTipoDocumento(tipo_doc);
        }

        if(c1.isSelected()){
            cracha = 1;
            c.setN_cracha(cracha);
            c1.setEnabled(false);
        }
        else if(c2.isSelected()){
            cracha = 2;
            c.setN_cracha(cracha);
            c2.setEnabled(false);
        }
        else if(c3.isSelected()){
            cracha = 3;
            c.setN_cracha(cracha);
            c3.setEnabled(false);
        }
        else if(c4.isSelected()){
            cracha = 4;
            c.setN_cracha(cracha);
            c4.setEnabled(false);
        }
        else if(c5.isSelected()){
            cracha = 5;
            c.setN_cracha(cracha);
            c5.setEnabled(false);
        }
        else if(c6.isSelected()){
            cracha = 6;
            c.setN_cracha(cracha);
            c6.setEnabled(false);
        }
        else if(c7.isSelected()){
            cracha = 7;
            c.setN_cracha(cracha);
            c7.setEnabled(false);
        }
        else if(c8.isSelected()){
            cracha = 8;
            c.setN_cracha(cracha);
            c8.setEnabled(false);
        }
        else if(c9.isSelected()){
            cracha = 9;
            c.setN_cracha(cracha);
            c9.setEnabled(false);
        }
        else if(c10.isSelected()){
            cracha = 10;
            c.setN_cracha(cracha);
            c10.setEnabled(false);
        }
        else if(c11.isSelected()){
            cracha = 11;
            c.setN_cracha(cracha);
            c11.setEnabled(false);
        }
        else if(c12.isSelected()){
            cracha = 12;
            c.setN_cracha(cracha);
            c12.setEnabled(false);
        }
        else if(c13.isSelected()){
            cracha = 13;
            c.setN_cracha(cracha);
            c13.setEnabled(false);
        }
        else if(c14.isSelected()){
            cracha = 14;
            c.setN_cracha(cracha);
            c14.setEnabled(false);
        }
        else if(c15.isSelected()){
            cracha = 15;
            c.setN_cracha(cracha);
            c15.setEnabled(false);
        }
        else if(c16.isSelected()){
            cracha = 16;
            c.setN_cracha(cracha);
            c16.setEnabled(false);
        }
        else if(c17.isSelected()){
            cracha = 17;
            c.setN_cracha(cracha);
            c17.setEnabled(false);
        }
        else if(c18.isSelected()){
            cracha = 18;
            c.setN_cracha(cracha);
            c18.setEnabled(false);
        }
        else if(c19.isSelected()){
            cracha = 19;
            c.setN_cracha(cracha);
            c19.setEnabled(false);
        }
        else if(c20.isSelected()){
            cracha = 20;
            c.setN_cracha(cracha);
            c20.setEnabled(false);
        }

        else{
            JOptionPane.showMessageDialog(null,"O usuário precisa estar relacionado à um crachá!");
            return;
        }

        if(Civil.isSelected()== true){
            c.setTipoVisitante("Civil");
        }
        else if(Militar.isSelected()== true){
            c.setTipoVisitante("Militar");
        }
        else if(Fornec.isSelected()== true){
            c.setTipoVisitante("Fornecedor");
        }else{
            JOptionPane.showMessageDialog(null,"Selecione o tipo do visitante!");
            return;
        }

        c.setData(sdf.format(new Date()));
        c.setHoraE(sdh.format(new Date()));
        c.setHoraS(null);
        c.setCor_veiculo(VeiculosFrame.cor);
        c.setModelo_veiculo(VeiculosFrame.modelo);
        c.setMarca_veiculo(VeiculosFrame.marca);
        c.setPlaca_veiculo(VeiculosFrame.placa2);

        VeiculosFrame.cor = null;
        VeiculosFrame.modelo = null;
        VeiculosFrame.marca = null;
        VeiculosFrame.placa2 = null;

        dao.create(c);
        readJTable();

        buttonGroup1.clearSelection();
        buttonGroup2.clearSelection();
        imageArray = null;
        foto_visitante.setIcon(null);
        redefinir_visitante.setEnabled(false);
        cadastrar_visitante.setEnabled(false);
        nome_visitante.setEnabled(false);
        numero_doc_visitante.setEnabled(false);
        destino_visitante.setEnabled(false);
        com_quem_falar_visitante.setEnabled(false);
        telefone_visitante.setEnabled(false);
        Civil.setEnabled(false);
        Militar.setEnabled(false);
        Fornec.setEnabled(false);
        tipo_doc_visitante.setEnabled(false);

        c1.setEnabled(false);
        c2.setEnabled(false);
        c3.setEnabled(false);
        c4.setEnabled(false);
        c5.setEnabled(false);
        c6.setEnabled(false);
        c7.setEnabled(false);
        c8.setEnabled(false);
        c9.setEnabled(false);
        c10.setEnabled(false);
        c11.setEnabled(false);
        c12.setEnabled(false);
        c13.setEnabled(false);
        c14.setEnabled(false);
        c15.setEnabled(false);
        c16.setEnabled(false);
        c17.setEnabled(false);
        c18.setEnabled(false);
        c19.setEnabled(false);
        c20.setEnabled(false);

        nome_visitante.setText("");
        numero_doc_visitante.setText("");
        destino_visitante.setText("");
        telefone_visitante.setText("");
        com_quem_falar_visitante.setText("");
        Civil.setSelected(false);
        Militar.setSelected(false);
        Fornec.setSelected(false);
        tipo_doc_visitante.setSelectedIndex(0);
        novo_visitante.setEnabled(true);
        red = 0;
        txt_info.setText("Dispositivo de vídeo:" + Webcam.getDefault().toString() + "  -- Data e hora da útima atualização:" + sdf.format(new Date()) + " " + sdh.format(new Date()));
    }//GEN-LAST:event_cadastrar_visitanteActionPerformed

    private void telefone_visitanteActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_telefone_visitanteActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_telefone_visitanteActionPerformed

    private void com_quem_falar_visitanteActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_com_quem_falar_visitanteActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_com_quem_falar_visitanteActionPerformed

    private void tipo_doc_visitanteActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_tipo_doc_visitanteActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_tipo_doc_visitanteActionPerformed

    private void pesquisa_registro_visitantesKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_pesquisa_registro_visitantesKeyReleased
        try {
            ListaDePesquisa();
        } catch (SQLException ex) {
            Logger.getLogger(Cadastro.class.getName()).log(Level.SEVERE, null, ex);
        }
    }//GEN-LAST:event_pesquisa_registro_visitantesKeyReleased

    private void pesquisa_registro_visitantesActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_pesquisa_registro_visitantesActionPerformed
        lista_pesquisa_registro_visitantes.setVisible(false);
    }//GEN-LAST:event_pesquisa_registro_visitantesActionPerformed

    private void lista_pesquisa_registro_visitantesMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_lista_pesquisa_registro_visitantesMouseClicked
            try {
                ResultadoPesquisa();
            } catch (SQLException ex) {
                Logger.getLogger(Cadastro.class.getName()).log(Level.SEVERE, null, ex);
            } catch (IOException ex) {
                Logger.getLogger(Cadastro.class.getName()).log(Level.SEVERE, null, ex);
            }
        lista_pesquisa_registro_visitantes.setVisible(false);
    }//GEN-LAST:event_lista_pesquisa_registro_visitantesMouseClicked

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("GTK+".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(Cadastro.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(Cadastro.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(Cadastro.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(Cadastro.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                try {
                    new Cadastro().setVisible(true);
                } catch (SQLException ex) {
                    Logger.getLogger(Cadastro.class.getName()).log(Level.SEVERE, null, ex);
                }
            }
        });
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    public static javax.swing.JRadioButton Civil;
    public static javax.swing.JRadioButton Fornec;
    public static javax.swing.JRadioButton Militar;
    private javax.swing.JButton associar_button;
    private javax.swing.ButtonGroup buttonGroup1;
    private javax.swing.ButtonGroup buttonGroup2;
    private javax.swing.JCheckBox c1;
    private javax.swing.JCheckBox c10;
    private javax.swing.JCheckBox c11;
    private javax.swing.JCheckBox c12;
    private javax.swing.JCheckBox c13;
    private javax.swing.JCheckBox c14;
    private javax.swing.JCheckBox c15;
    private javax.swing.JCheckBox c16;
    private javax.swing.JCheckBox c17;
    private javax.swing.JCheckBox c18;
    private javax.swing.JCheckBox c19;
    private javax.swing.JCheckBox c2;
    private javax.swing.JCheckBox c20;
    private javax.swing.JCheckBox c3;
    private javax.swing.JCheckBox c4;
    private javax.swing.JCheckBox c5;
    private javax.swing.JCheckBox c6;
    private javax.swing.JCheckBox c7;
    private javax.swing.JCheckBox c8;
    private javax.swing.JCheckBox c9;
    private javax.swing.JButton cadastrar_entrada;
    private javax.swing.JButton cadastrar_saida;
    private javax.swing.JButton cadastrar_visitante;
    private javax.swing.JButton capturar_video_controle_entrada;
    private javax.swing.JButton capturar_video_controle_saida;
    private javax.swing.JButton capturar_video_registro_visitantes;
    private javax.swing.JTextField com_quem_falar_visitante;
    public static javax.swing.JTable controle_tabela;
    private javax.swing.JTable controle_tabela_saida;
    private javax.swing.JTable controle_tabela_saida1;
    private javax.swing.JButton def_horario_entrada_controle;
    private javax.swing.JButton def_horario_saida_entrada;
    private javax.swing.JButton def_horario_saida_visitante;
    private javax.swing.JTextField destino_visitante;
    private javax.swing.JButton ferramentas_adm_controle_entrada;
    private javax.swing.JButton ferramentas_adm_controle_saida;
    private javax.swing.JButton ferramentas_adm_visitante;
    public static javax.swing.JLabel foto_controle_entrada;
    public static javax.swing.JLabel foto_controle_saida;
    public static javax.swing.JLabel foto_visitante;
    private javax.swing.JButton iniciar_video_controle_entrada;
    private javax.swing.JButton iniciar_video_controle_saida;
    private javax.swing.JButton iniciar_video_registro_visitantes;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel11;
    private javax.swing.JLabel jLabel12;
    private javax.swing.JLabel jLabel13;
    private javax.swing.JLabel jLabel14;
    private javax.swing.JLabel jLabel15;
    private javax.swing.JLabel jLabel16;
    private javax.swing.JLabel jLabel18;
    private javax.swing.JLabel jLabel19;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel20;
    private javax.swing.JLabel jLabel21;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel10;
    private javax.swing.JPanel jPanel12;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel4;
    private javax.swing.JPanel jPanel5;
    private javax.swing.JPanel jPanel7;
    private javax.swing.JPanel jPanel8;
    private javax.swing.JPanel jPanel9;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JScrollPane jScrollPane3;
    private javax.swing.JScrollPane jScrollPane4;
    private javax.swing.JScrollPane jScrollPane5;
    private javax.swing.JScrollPane jScrollPane6;
    private javax.swing.JScrollPane jScrollPane7;
    private javax.swing.JTabbedPane jTabbedPane1;
    private javax.swing.JList<String> lista_pesquisa_controle_entrada;
    private javax.swing.JList<String> lista_pesquisa_controle_saida;
    private javax.swing.JList<String> lista_pesquisa_registro_visitantes;
    private javax.swing.JTextField motivo_controle_entrada;
    private javax.swing.JTextField motivo_controle_saida;
    private javax.swing.JTextField nome_guerra_controle_entrada;
    private javax.swing.JTextField nome_guerra_controle_saida;
    public static javax.swing.JTextField nome_visitante;
    private javax.swing.JButton novo_entrada;
    private javax.swing.JButton novo_saida;
    private javax.swing.JButton novo_visitante;
    public static javax.swing.JTextField numero_doc_visitante;
    private javax.swing.JTextField pesquisa_controle_entrada;
    private javax.swing.JTextField pesquisa_controle_saida;
    private javax.swing.JTextField pesquisa_registro_visitantes;
    private javax.swing.JComboBox<String> posto_graduacao_controle_entrada;
    private javax.swing.JComboBox<String> posto_graduacao_controle_saida;
    private javax.swing.JButton redefinir_entrada;
    private javax.swing.JButton redefinir_saida;
    private javax.swing.JButton redefinir_visitante;
    private javax.swing.JButton sair_button;
    private javax.swing.JButton sair_controle;
    private javax.swing.JButton sair_controle1;
    private javax.swing.JComboBox<String> sessao_controle_entrada;
    private javax.swing.JComboBox<String> sessao_controle_saida;
    public static javax.swing.JFormattedTextField telefone_visitante;
    public static javax.swing.JComboBox<String> tipo_doc_visitante;
    private javax.swing.JLabel txtVisitante;
    private javax.swing.JTextPane txt_info;
    private javax.swing.JTextPane txt_info2;
    private javax.swing.JTextPane txt_info3;
    // End of variables declaration//GEN-END:variables
    public void readJTable(){
        SimpleDateFormat sdh = new SimpleDateFormat("dd/MM/yyyy");
        DefaultTableModel modelo = (DefaultTableModel) controle_tabela.getModel();
        modelo.setNumRows(0);
        cadastroDAO cdao = new cadastroDAO();
        
        for(CadastroBEAN c: cdao.read(sdh.format(new Date()))){
            modelo.addRow(new Object[]{
                c.getId(),
                c.getN_cracha(),
                c.getNomeCompleto(),
                c.getTipoDocumento(),
                c.getDocumentoIden(),
                c.getDestino(),
                c.getComquemFalar(),
                c.getTelefone(),
                c.getTipoVisitante(),
                c.getData(),
                c.getHoraE(),
                c.getHoraS()});
        }
        corTabela();
    }
    
    public void readJTable_controle(){
        SimpleDateFormat sdh = new SimpleDateFormat("dd/MM/yyyy");
        DefaultTableModel modelo2 = (DefaultTableModel) controle_tabela_saida.getModel();
        modelo2.setNumRows(0);
        controleDAO cdao = new controleDAO();
        
        for(ControleExpedienteBEAN c: cdao.read_controle(sdh.format(new Date()))){
            modelo2.addRow(new Object[]{
                c.getId(),
                c.getGrad_posto(),
                c.getNome_guerra(),
                c.getSessao(),
                c.getData(),
                c.getHora_saida(),
                c.getHora_entrada(),
                c.getMotivo_saida()});
        }
        corTabela_controle();
    }
    
    public void readJTable_controlef(){
        SimpleDateFormat sdh = new SimpleDateFormat("dd/MM/yyyy");
        DefaultTableModel modelo2 = (DefaultTableModel) controle_tabela_saida1.getModel();
        modelo2.setNumRows(0);
        controlefDAO cfdao = new controlefDAO();
        
        for(ControleForaExpedienteBEAN cf: cfdao.read_controlef(sdh.format(new Date()))){
            modelo2.addRow(new Object[]{
                cf.getId(),
                cf.getGrad_posto(),
                cf.getNome_guerra(),
                cf.getSessao(),
                cf.getData(),
                cf.getHora_entrada(),
                cf.getHora_saida(),
                cf.getMotivo_entrada()});
        }
        corTabela_controlef();
    }
    
    public void INICIALIZA(){
        try{
            dimensao_default = WebcamResolution.VGA.getSize();
            WEBCAM = Webcam.getDefault();
            WEBCAM.setViewSize(dimensao_default);
        }catch(WebcamException e){
            JOptionPane.showMessageDialog(null,"Erro na inicialização do dispositivo de vídeo!\nVerifique se o dispositivo está corretamente instalado.");
        }
    }
    
    private void INICIALIZA_VIDEO(JLabel label){
        new Thread(){
            @Override
            public void run(){
                while(true&&executando){
                    try{
                        Image imagem = WEBCAM.getImage();
                        ImageIcon icon = new ImageIcon(imagem);
                        icon.setImage(icon.getImage().getScaledInstance(label.getWidth(),label.getHeight(),100));
                        label.setIcon(icon);
                        Thread.sleep(50);
                    }catch(InterruptedException e){
                        System.out.println(e);
                    }
                }
            }
        }.start();
    }
    
    public static byte[] getImgBytes(BufferedImage image) throws IOException{
        ByteArrayOutputStream baos = new ByteArrayOutputStream();
        try{
            ImageIO.write(image, "JPEG", baos);
        }catch(IOException ex){
            System.err.println("Erro ao gerar bytes");
        }
        
        InputStream is = new ByteArrayInputStream(baos.toByteArray());
        
        return baos.toByteArray();
    }
    
    public static void exibirImagemLabel(byte[] img, javax.swing.JLabel label){
        if(img != null){
            InputStream input = new ByteArrayInputStream(img);
            try{
                BufferedImage imagem = ImageIO.read(input);
                label.setIcon(new ImageIcon(imagem));
            }catch(IOException ex){
                System.err.println("Erro ao converter imagem");
            }
        }
    }
    
    public void corTabela(){
        controle_tabela.setDefaultRenderer(Object.class, new DefaultTableCellRenderer(){
            @Override
            public Component getTableCellRendererComponent(JTable table, Object value,
                                                           boolean isSelected, boolean hasFocus,
                                                           int row, int column){
                JLabel label = (JLabel) super.getTableCellRendererComponent(table, value, isSelected, hasFocus, row, column);
            //***********************
            Color c = Color.WHITE;
            Object texto = table.getValueAt(row,11);
            if(texto == null)
                c = Color.RED;
            label.setBackground(c);
            controle_tabela.setSelectionForeground(Color.BLUE);
            //***********************
            
            return label;
            }
        });
    }
    
    public void corTabela_controle(){
        String CLASS = "";
        controle_tabela_saida.setDefaultRenderer(Object.class, new DefaultTableCellRenderer(){
            @Override
            public Component getTableCellRendererComponent(JTable table, Object value,
                                                           boolean isSelected, boolean hasFocus,
                                                           int row, int column){
                JLabel label = (JLabel) super.getTableCellRendererComponent(table, value, isSelected, hasFocus, row, column);
            //***********************
            Color c = Color.WHITE;
            Object texto = table.getValueAt(row,6);
            if(texto != null && CLASS.equals(texto.toString()))
                c = Color.RED;
            label.setBackground(c);
            controle_tabela_saida.setSelectionForeground(Color.BLUE);
            //***********************
            
            return label;
            }
        });
    }
    
    public void corTabela_controlef(){
        String CLASS = "";
        controle_tabela_saida1.setDefaultRenderer(Object.class, new DefaultTableCellRenderer(){
            @Override
            public Component getTableCellRendererComponent(JTable table, Object value,
                                                           boolean isSelected, boolean hasFocus,
                                                           int row, int column){
                JLabel label = (JLabel) super.getTableCellRendererComponent(table, value, isSelected, hasFocus, row, column);
            //***********************
            Color c = Color.WHITE;
            Object texto = table.getValueAt(row,6);
            if(texto != null && CLASS.equals(texto.toString()))
                c = Color.RED;
            label.setBackground(c);
            controle_tabela_saida1.setSelectionForeground(Color.BLUE);
            //***********************
            
            return label;
            }
        });
    }
    
    public void ListaDePesquisa() throws SQLException{
        try{
            cadastroDAO dao = new cadastroDAO();
            dao.executaSQL("SELECT NomeCompleto FROM cadastro WHERE NomeCompleto LIKE '%" + pesquisa_registro_visitantes.getText() + "%' ORDER BY NomeCompleto");
            model_list.removeAllElements();
            int v = 0;
            while(dao.rs2.next() & v < 4){
                if(model_list.contains(dao.rs2.getString("NomeCompleto"))){
                    
                }else{
                    model_list.addElement(dao.rs2.getString("NomeCompleto"));
                    v++;
                }
            }
            if(v >= 1){
                lista_pesquisa_registro_visitantes.setVisible(true);
            }else{
                lista_pesquisa_registro_visitantes.setVisible(false);
            }
            //ResultadoPesquisa();
        }catch(SQLException ex){
            System.err.println("Erro ao listar dados" + ex);
        }
    }
    
    public void ListaDePesquisa_controle() throws SQLException{
        try{
            controleDAO cdao = new controleDAO();
            cdao.executaSQL("SELECT nome_guerra FROM controle_saida WHERE nome_guerra LIKE '%" + pesquisa_controle_saida.getText() + "%' ORDER BY nome_guerra");
            model_list2.removeAllElements();
            int v2 = 0;
            while(cdao.rs3.next() & v2 < 4){
                String resultado;
                resultado = cdao.rs3.getString("grad_posto") + " " + cdao.rs3.getString("nome_guerra");
                if(model_list2.contains(resultado)){
                
                }else{
                    model_list2.addElement(resultado);
                    v2++;
                }
            }
            if(v2 >= 1){
                lista_pesquisa_controle_saida.setVisible(true);
            }else{
                lista_pesquisa_controle_saida.setVisible(false);
            }
            //ResultadoPesquisa();
        }catch(SQLException ex){
            System.err.println("Erro ao listar dados" + ex);
        }
    }
    
    public void ListaDePesquisa_controlef(){
        try{
            controlefDAO cfdao = new controlefDAO();
            cfdao.executaSQL("SELECT nome_guerra FROM controlef_saida WHERE nome_guerra LIKE '%" + pesquisa_controle_entrada.getText() + "%' ORDER BY nome_guerra");
            model_list3.removeAllElements();
            int v3 = 0;
            while(cfdao.rs3.next() & v3 < 4){
                String resultado;
                resultado = cfdao.rs3.getString("grad_posto") + " " + cfdao.rs3.getString("nome_guerra");
                if(model_list3.contains(resultado)){
                    
                }else{
                    model_list3.addElement(resultado);
                    v3++;
                }
            }
            if(v3 >= 1){
                lista_pesquisa_controle_entrada.setVisible(true);
            }else{
                lista_pesquisa_controle_entrada.setVisible(false);
            }
            //ResultadoPesquisa();
        }catch(SQLException ex){
            System.err.println("Erro ao listar dados" + ex);
        }
    }
    
    public void ResultadoPesquisa() throws SQLException, IOException{
        String tipo_doc;
        String tipo_v;
        cadastroDAO dao = new cadastroDAO();
        for(CadastroBEAN c: dao.preenche_pesquisa(lista_pesquisa_registro_visitantes.getSelectedValue().toString())){
            nome_visitante.setText(c.getNomeCompleto());
            telefone_visitante.setText(c.getTelefone());
            numero_doc_visitante.setText(c.getDocumentoIden());
            tipo_doc = c.getTipoDocumento();
            tipo_v = c.getTipoVisitante();
            tipo_doc_visitante.setSelectedItem(tipo_doc);
            if(tipo_v.equals("Civil")){
                Civil.setSelected(true);
            }if(tipo_v.equals("Militar")){
                Militar.setSelected(true);
            }if(tipo_v.equals("Fornecedor")){
                Fornec.setSelected(true);
            }
            exibirImagemLabel(c.getFoto(),foto_visitante);
            InputStream input = new ByteArrayInputStream(c.getFoto());
            BufferedImage imagem = ImageIO.read(input);
            imageArray = imagem;
        }
        lista_pesquisa_registro_visitantes.setVisible(false);
    }
    
    public void ResultadoPesquisa_controle(String grad_posto, String nome_guerra) throws SQLException, IOException{
        String posto_grad;
        String sessao;
        controleDAO cdao = new controleDAO();
        for(ControleExpedienteBEAN c: cdao.preenche_pesquisa_controle(grad_posto, nome_guerra)){
            nome_guerra_controle_saida.setText(c.getNome_guerra());
            posto_grad = c.getGrad_posto();
            sessao = c.getSessao();
            posto_graduacao_controle_saida.setSelectedItem(posto_grad);
            sessao_controle_saida.setSelectedItem(sessao);
            exibirImagemLabel(c.getImagem(),foto_controle_saida);
            InputStream input = new ByteArrayInputStream(c.getImagem());
            BufferedImage imagem = ImageIO.read(input);
            imageArray_controle = imagem;
        }
        lista_pesquisa_controle_saida.setVisible(false);
    }
    
    public void ResultadoPesquisa_controlef(String grad_posto, String nome_guerra) throws IOException{
        String posto_grad;
        String sessao;
        controlefDAO cfdao = new controlefDAO();
        for(ControleForaExpedienteBEAN cf: cfdao.preenche_pesquisa_controlef(grad_posto, nome_guerra)){
            nome_guerra_controle_entrada.setText(cf.getNome_guerra());
            posto_grad = cf.getGrad_posto();
            sessao = cf.getSessao();
            posto_graduacao_controle_entrada.setSelectedItem(posto_grad);
            sessao_controle_entrada.setSelectedItem(sessao);
            exibirImagemLabel(cf.getImagem(),foto_controle_entrada);
            InputStream input = new ByteArrayInputStream(cf.getImagem());
            BufferedImage imagem = ImageIO.read(input);
            imageArray_controlef = imagem;
        }
        lista_pesquisa_controle_entrada.setVisible(false);
    }
    
    public void verifica_check() throws SQLException{
        cadastroDAO dao = new cadastroDAO();
        
        if(dao.busca_cracha(1)){
            c1.setEnabled(false);
        }else{
            c1.setEnabled(true);
        }
        
        if(dao.busca_cracha(2)){
            c2.setEnabled(false);
        }else{
            c2.setEnabled(true);
        }
        
        if(dao.busca_cracha(3)){
            c3.setEnabled(false);
        }else{
            c3.setEnabled(true);
        }
        
        if(dao.busca_cracha(4)){
            c4.setEnabled(false);
        }else{
            c4.setEnabled(true);
        }
        
        if(dao.busca_cracha(5)){
            c5.setEnabled(false);
        }else{
            c5.setEnabled(true);
        }
        
        if(dao.busca_cracha(6)){
            c6.setEnabled(false);
        }else{
            c6.setEnabled(true);
        }
        
        if(dao.busca_cracha(7)){
            c7.setEnabled(false);
        }else{
            c7.setEnabled(true);
        }
        
        if(dao.busca_cracha(8)){
            c8.setEnabled(false);
        }else{
            c8.setEnabled(true);   
        }
        
        if(dao.busca_cracha(9)){
            c9.setEnabled(false);
        }else{
            c9.setEnabled(true);
        }
        
        if(dao.busca_cracha(10)){
            c10.setEnabled(false);
        }else{
            c10.setEnabled(true);
        }
        
        if(dao.busca_cracha(11)){
            c11.setEnabled(false);
        }else{
            c11.setEnabled(true);
        }
        
        if(dao.busca_cracha(12)){
            c12.setEnabled(false);
        }else{
            c12.setEnabled(true);
        }
        
        if(dao.busca_cracha(13)){
            c13.setEnabled(false);
        }else{
            c13.setEnabled(true);
        }
        
        if(dao.busca_cracha(14)){
            c14.setEnabled(false);
        }else{
            c14.setEnabled(true);
        }
        
        if(dao.busca_cracha(15)){
            c15.setEnabled(false);
        }else{
            c15.setEnabled(true);
        }
        
        if(dao.busca_cracha(16)){
            c16.setEnabled(false);
        }else{
            c16.setEnabled(true);
        }
        
        if(dao.busca_cracha(17)){
            c17.setEnabled(false);
        }else{
            c17.setEnabled(true);
        }
        
        if(dao.busca_cracha(18)){
            c18.setEnabled(false);
        }else{
            c18.setEnabled(true);
        }
        
        if(dao.busca_cracha(19)){
            c19.setEnabled(false);
        }else{
            c19.setEnabled(true);
        }
        
        if(dao.busca_cracha(20)){
            c20.setEnabled(false);
        }else{
            c20.setEnabled(true);
        }
    }
    
    private void desativa_botoes_encerra_sv(){
        //Registro de visitantes
        pesquisa_registro_visitantes.setEnabled(false);
        iniciar_video_registro_visitantes.setEnabled(false);
        capturar_video_registro_visitantes.setEnabled(false);
        novo_visitante.setEnabled(false);
        nome_visitante.setEnabled(false);
        tipo_doc_visitante.setEnabled(false);
        numero_doc_visitante.setEnabled(false);
        telefone_visitante.setEnabled(false);
        buttonGroup1.clearSelection();
        Civil.setEnabled(false);
        Militar.setEnabled(false);
        Fornec.setEnabled(false);
        c1.setEnabled(false);
        c2.setEnabled(false);
        c3.setEnabled(false);
        c4.setEnabled(false);
        c5.setEnabled(false);
        c6.setEnabled(false);
        c7.setEnabled(false);
        c8.setEnabled(false);
        c9.setEnabled(false);
        c10.setEnabled(false);
        c11.setEnabled(false);
        c12.setEnabled(false);
        c13.setEnabled(false);
        c14.setEnabled(false);
        c15.setEnabled(false);
        c16.setEnabled(false);
        c17.setEnabled(false);
        c18.setEnabled(false);
        c19.setEnabled(false);
        c20.setEnabled(false);
        destino_visitante.setEnabled(false);
        com_quem_falar_visitante.setEnabled(false);
        associar_button.setEnabled(false);
        redefinir_visitante.setEnabled(false);
        cadastrar_visitante.setEnabled(false);
        def_horario_saida_visitante.setEnabled(false);
        controle_tabela.setEnabled(false);
        
        //Controle saída CB/SD
        pesquisa_controle_saida.setEnabled(false);
        lista_pesquisa_controle_saida.setEnabled(false);
        posto_graduacao_controle_saida.setEnabled(false);
        nome_guerra_controle_saida.setEnabled(false);
        sessao_controle_saida.setEnabled(false);
        motivo_controle_saida.setEnabled(false);
        iniciar_video_controle_saida.setEnabled(false);
        capturar_video_controle_saida.setEnabled(false);
        novo_saida.setEnabled(false);
        redefinir_saida.setEnabled(false);
        cadastrar_saida.setEnabled(false);
        controle_tabela_saida.setEnabled(false);
        def_horario_entrada_controle.setEnabled(false);
        
        //Controle entrada fora do expediente
        pesquisa_controle_entrada.setEnabled(false);
        lista_pesquisa_controle_entrada.setEnabled(false);
        posto_graduacao_controle_entrada.setEnabled(false);
        nome_guerra_controle_entrada.setEnabled(false);
        sessao_controle_entrada.setEnabled(false);
        motivo_controle_entrada.setEnabled(false);
        iniciar_video_controle_entrada.setEnabled(false);
        capturar_video_controle_entrada.setEnabled(false);
        novo_entrada.setEnabled(false);
        redefinir_entrada.setEnabled(false);
        cadastrar_entrada.setEnabled(false);
        def_horario_saida_entrada.setEnabled(false);
    }
    
    public void inicia_botoes_inicia_sv(){
        //Registro de visitantes
        pesquisa_registro_visitantes.setEnabled(true);
        iniciar_video_registro_visitantes.setEnabled(true);
        capturar_video_registro_visitantes.setEnabled(false);
        novo_visitante.setEnabled(true);
        nome_visitante.setEnabled(false);
        tipo_doc_visitante.setEnabled(false);
        numero_doc_visitante.setEnabled(false);
        telefone_visitante.setEnabled(false);
        buttonGroup1.clearSelection();
        Civil.setEnabled(false);
        Militar.setEnabled(false);
        Fornec.setEnabled(false);
        c1.setEnabled(false);
        c2.setEnabled(false);
        c3.setEnabled(false);
        c4.setEnabled(false);
        c5.setEnabled(false);
        c6.setEnabled(false);
        c7.setEnabled(false);
        c8.setEnabled(false);
        c9.setEnabled(false);
        c10.setEnabled(false);
        c11.setEnabled(false);
        c12.setEnabled(false);
        c13.setEnabled(false);
        c14.setEnabled(false);
        c15.setEnabled(false);
        c16.setEnabled(false);
        c17.setEnabled(false);
        c18.setEnabled(false);
        c19.setEnabled(false);
        c20.setEnabled(false);
        destino_visitante.setEnabled(false);
        com_quem_falar_visitante.setEnabled(false);
        associar_button.setEnabled(false);
        redefinir_visitante.setEnabled(false);
        cadastrar_visitante.setEnabled(false);
        def_horario_saida_visitante.setEnabled(false);
        controle_tabela.setEnabled(true);
        
        //Controle de Saída de CB/SD
        pesquisa_controle_saida.setEnabled(true);
        lista_pesquisa_controle_saida.setEnabled(true);
        posto_graduacao_controle_saida.setEnabled(false);
        nome_guerra_controle_saida.setEnabled(false);
        sessao_controle_saida.setEnabled(false);
        motivo_controle_saida.setEnabled(false);
        iniciar_video_controle_saida.setEnabled(true);
        capturar_video_controle_saida.setEnabled(false);
        novo_saida.setEnabled(true);
        redefinir_saida.setEnabled(false);
        cadastrar_saida.setEnabled(false);
        controle_tabela_saida.setEnabled(true);
        def_horario_entrada_controle.setEnabled(false);
        
        //Controle de entrada fora do expediente
        pesquisa_controle_entrada.setEnabled(true);
        lista_pesquisa_controle_entrada.setEnabled(true);
        posto_graduacao_controle_entrada.setEnabled(false);
        nome_guerra_controle_entrada.setEnabled(false);
        sessao_controle_entrada.setEnabled(false);
        motivo_controle_entrada.setEnabled(false);
        iniciar_video_controle_entrada.setEnabled(true);
        capturar_video_controle_entrada.setEnabled(false);
        novo_entrada.setEnabled(true);
        redefinir_entrada.setEnabled(false);
        cadastrar_entrada.setEnabled(false);
        def_horario_saida_entrada.setEnabled(false);
    }
}
